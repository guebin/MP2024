<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="최규빈">
<meta name="dcterms.date" content="2024-11-09">

<title>MP2024 - 09wk-2: model의 입력파악, model의 사용연습</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MP2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../quiz.html"> 
<span class="menu-text"><strong>Quiz</strong></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/MP2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=2"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#강의영상" id="toc-강의영상" class="nav-link active" data-scroll-target="#강의영상">1. 강의영상</a></li>
  <li><a href="#imports" id="toc-imports" class="nav-link" data-scroll-target="#imports">2. Imports</a></li>
  <li><a href="#model-입력파악" id="toc-model-입력파악" class="nav-link" data-scroll-target="#model-입력파악">3. Model 입력파악</a></li>
  <li><a href="#model-사용-연습" id="toc-model-사용-연습" class="nav-link" data-scroll-target="#model-사용-연습">4. Model 사용 연습</a>
  <ul class="collapse">
  <li><a href="#a.-텍스트" id="toc-a.-텍스트" class="nav-link" data-scroll-target="#a.-텍스트">A. 텍스트</a></li>
  <li><a href="#b.-이미지" id="toc-b.-이미지" class="nav-link" data-scroll-target="#b.-이미지">B. 이미지</a></li>
  <li><a href="#c.-동영상" id="toc-c.-동영상" class="nav-link" data-scroll-target="#c.-동영상">C. 동영상</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="09wk-2.out.ipynb" download="09wk-2.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">09wk-2: <code>model</code>의 입력파악, <code>model</code>의 사용연습</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>최규빈 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 9, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/guebin/MP2024/blob/main/posts/09wk-2.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" style="text-align: left"></a></p>
<section id="강의영상" class="level1">
<h1>1. 강의영상</h1>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/playlist?list=PLQqh36zP38-xsRgsXpLEUNWClxLi0N9Mk&amp;si=Lssxzw70RRT1adiJ" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<div id="cell-4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip uninstall mp2024pkg <span class="op">-</span>y </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install git<span class="op">+</span>https:<span class="op">//</span>github.com<span class="op">/</span>guebin<span class="op">/</span>mp2024pkg.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found existing installation: mp2024pkg 1.0
Uninstalling mp2024pkg-1.0:
  Successfully uninstalled mp2024pkg-1.0
Collecting git+https://github.com/guebin/mp2024pkg.git
  Cloning https://github.com/guebin/mp2024pkg.git to /tmp/pip-req-build-178x45er
  Running command git clone --filter=blob:none --quiet https://github.com/guebin/mp2024pkg.git /tmp/pip-req-build-178x45er
  Resolved https://github.com/guebin/mp2024pkg.git to commit 2adb5fc04e589895edd76ec5da87aa37bf0dd70b
  Preparing metadata (setup.py) ... done
Building wheels for collected packages: mp2024pkg
  Building wheel for mp2024pkg (setup.py) ... done
  Created wheel for mp2024pkg: filename=mp2024pkg-1.0-py3-none-any.whl size=4588 sha256=84356f47d6566dcda64e0d93070d9a1d9b6d9c9f962769858a4d823b589fe40b
  Stored in directory: /tmp/pip-ephem-wheel-cache-n0_tsfan/wheels/83/81/b1/63c03ca869bb1a35a588dce54e83ea32c6c21e6af0bbeaa640
Successfully built mp2024pkg
Installing collected packages: mp2024pkg
Successfully installed mp2024pkg-1.0</code></pre>
</div>
</div>
</section>
<section id="imports" class="level1">
<h1>2. Imports</h1>
<div id="cell-6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> transformers</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datasets</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> huggingface_hub</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytorchvideo.data</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PIL</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tarfile</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mp2024pkg <span class="im">as</span> mp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/cgb3/anaconda3/envs/hf/lib/python3.12/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm</code></pre>
</div>
</div>
</section>
<section id="model-입력파악" class="level1">
<h1>3. Model 입력파악</h1>
<p><code>-</code> 아래중 하나의 방법순으로..</p>
<ul>
<li>방법1: <code>model.forward?</code> 에서 시그니처를 확인</li>
<li>방법2: <code>model.forward?</code> 에서 사용예제를 확인</li>
<li>방법3: 인터넷을 활용한 외부 자료 확인 (공식문서, 공식튜토리얼, 신뢰할만한 블로그, ChatGPT등)</li>
<li>방법4: <code>model.forward??</code> 를 보고 모든 코드를 뜯어봄 &lt;— 하지마세요</li>
</ul>
<p><code>-</code> 모델의 입력이 어떤형태로 정리되어야 하는지 알아내는 확실한 방법은 없음</p>
<ul>
<li>방법1,2,3 은 다른사람의 호의에 기대해야함.</li>
<li>방법4는 사실상 불가능</li>
</ul>
<p><code># 예제1</code> – 텍스트분류</p>
<div id="cell-11" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> transformers.AutoModelForSequenceClassification.from_pretrained(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span>, num_labels<span class="op">=</span><span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert/distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><em>모델의 기본정보(config)</em></p>
<div id="cell-13" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model1.config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>DistilBertConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "distilbert/distilbert-base-uncased",
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "transformers_version": "4.46.2",
  "vocab_size": 30522
}</code></pre>
</div>
</div>
<ul>
<li>max_position_embeddings: 512</li>
</ul>
<p><em>모델의 입력파악</em></p>
<div id="cell-16" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model1.forward? </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -- 결과가 너무 길어서 생략</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>사용예시1 – 입력나열, loss O</em></p>
<div id="cell-18" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model1(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> torch.tensor([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]]),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>SequenceClassifierOutput(loss=tensor(0.7676, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.0565,  0.0915],
        [-0.0557,  0.0837]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시2 – <code>**딕셔너리</code>, loss O</em></p>
<div id="cell-20" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model1_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> torch.tensor([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]]),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>model1(<span class="op">**</span>model1_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>SequenceClassifierOutput(loss=tensor(0.7676, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.0565,  0.0915],
        [-0.0557,  0.0837]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시3 – 입력나열, loss X</em></p>
<div id="cell-22" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model1(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> torch.tensor([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0565,  0.0915],
        [-0.0557,  0.0837]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시4 – <code>**딕셔너리</code>, loss X</em></p>
<div id="cell-24" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model1_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> torch.tensor([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]])</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>model1(<span class="op">**</span>model1_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0565,  0.0915],
        [-0.0557,  0.0837]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시5 – 초간단, loss X</em></p>
<div id="cell-26" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model1(torch.tensor([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0565,  0.0915],
        [-0.0557,  0.0837]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>사용예시1~5에서 <code>model1()</code> 대신에 <code>model1.forward()</code>를 사용해도 된다.</p>
</blockquote>
<p><code>#</code></p>
<p><code># 예제2</code> – 이미지분류</p>
<div id="cell-30" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    num_labels<span class="op">=</span><span class="dv">3</span> <span class="co"># 그냥 대충 3이라고 했음.. 별 이유는 없음</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><em>모델의 기본정보(config)</em></p>
<div id="cell-32" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model2.config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>ViTConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.46.2"
}</code></pre>
</div>
</div>
<ul>
<li>image_size: 224</li>
</ul>
<div id="cell-34" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mp.tab(model2)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -- 결과가 너무 길어서 생략 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model2.config.num_channels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>3</code></pre>
</div>
</div>
<p><em>모델의 입력파악</em></p>
<div id="cell-37" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model2.forward?</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -- 결과가 너무 길어서 생략</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-38" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">64</span>,<span class="dv">64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>tensor([[[[ 0.3649, -1.2605,  0.2920,  ..., -0.9787, -1.4717,  0.4677],
          [ 0.4702, -0.2664,  2.0551,  ..., -1.4783,  2.6271, -0.7880],
          [ 1.0891,  0.1022,  0.0211,  ...,  0.5663,  0.9881, -0.2273],
          ...,
          [ 0.2803,  1.3142,  0.4706,  ..., -1.1566,  0.1984,  1.4354],
          [ 0.2090,  0.6016,  0.5450,  ..., -0.1247,  0.8066, -0.2222],
          [ 1.1755,  1.1512,  0.7503,  ..., -1.2212,  0.2055,  0.3130]],

         [[ 0.0515, -0.7000, -1.4944,  ...,  0.5087,  0.7801, -0.0497],
          [-0.6095,  0.6269, -0.2168,  ..., -1.0991, -1.9875,  0.6154],
          [ 0.3600,  0.1016, -2.0896,  ..., -2.1648, -0.7579, -0.0747],
          ...,
          [-1.4642, -1.3562, -0.9592,  ..., -0.8820,  2.6860, -1.0333],
          [-1.6126,  0.2651,  0.3171,  ...,  0.4368, -0.2348, -0.5822],
          [ 0.6224,  0.8832,  0.4589,  ..., -1.3447,  0.5074, -1.2563]],

         [[-0.1654,  0.4390, -0.3119,  ..., -0.7779,  1.6596, -1.8286],
          [ 0.6203, -0.0072,  0.5610,  ...,  1.1161,  1.4232, -1.1180],
          [-0.3927,  2.7406,  0.6024,  ...,  0.2374,  0.8350, -1.3866],
          ...,
          [-1.0612,  0.6898,  0.5559,  ..., -1.7000, -0.3696, -0.7335],
          [-0.3483,  1.0322, -0.3756,  ..., -0.6278, -1.5500,  1.3041],
          [ 0.3224,  1.6797,  0.8219,  ...,  0.7146, -0.0869,  0.9379]]],


        [[[ 0.0124, -0.9813,  0.4385,  ...,  0.0203,  0.1493,  0.0797],
          [ 0.6513,  0.8768, -0.3780,  ...,  0.9154, -0.1878,  1.2205],
          [ 0.1238, -0.1669,  0.1737,  ...,  0.8929,  0.4685,  0.4024],
          ...,
          [-0.4388,  0.1257, -0.3490,  ..., -1.1260, -1.2975, -0.8466],
          [-0.5190, -0.1010,  1.6575,  ...,  0.7269, -1.4265, -1.0750],
          [ 1.9482, -0.7578, -0.3996,  ..., -0.2626, -1.3259,  0.5262]],

         [[ 1.9872, -1.0255,  0.1767,  ...,  0.6125, -0.5061,  0.8420],
          [ 0.7715, -0.5411, -1.4627,  ..., -2.6088, -0.5574,  0.5872],
          [ 1.3500, -0.6974, -1.0678,  ...,  0.3034, -0.1847, -0.5619],
          ...,
          [ 1.4522, -0.4482, -0.8592,  ...,  0.4603,  0.6203, -0.2643],
          [-0.1335,  1.5470, -0.4339,  ..., -1.5276, -0.9974,  0.1557],
          [ 0.4852, -0.0337, -0.1306,  ..., -2.4541, -1.3687, -0.6767]],

         [[-0.9349,  1.5542, -0.8323,  ...,  0.6367,  0.8844,  1.3362],
          [-0.5194, -1.8781, -0.4988,  ..., -1.5334,  0.5765,  0.0722],
          [-1.5885, -2.2619,  0.5158,  ...,  0.6815, -0.0635, -0.0362],
          ...,
          [ 0.5923,  0.4383, -1.0135,  ..., -0.3842,  0.3017, -2.5947],
          [-0.7695,  0.5169, -0.4380,  ...,  3.1244, -0.3718,  0.8871],
          [-1.9921,  0.0219, -0.1598,  ..., -0.2551,  0.3711,  0.4163]]]])</code></pre>
</div>
</div>
<p><em>사용예시1 – 입력나열, loss O</em></p>
<div id="cell-40" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>model2(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>ImageClassifierOutput(loss=tensor(1.1627, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.1805,  0.0750,  0.0782],
        [-0.1494,  0.0548,  0.0913]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시2 – <code>**딕셔너리</code>, loss O</em></p>
<div id="cell-42" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model2_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>model2(<span class="op">**</span>model2_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>ImageClassifierOutput(loss=tensor(1.1627, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.1805,  0.0750,  0.0782],
        [-0.1494,  0.0548,  0.0913]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시3 – 입력나열, loss X</em></p>
<div id="cell-44" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>model2(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.1805,  0.0750,  0.0782],
        [-0.1494,  0.0548,  0.0913]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시4 – <code>**딕셔너리</code>, loss X</em></p>
<div id="cell-46" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>model2_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>model2(<span class="op">**</span>model2_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.1805,  0.0750,  0.0782],
        [-0.1494,  0.0548,  0.0913]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시5 – 초간단, loss X</em></p>
<div id="cell-48" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>model2(torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.1805,  0.0750,  0.0782],
        [-0.1494,  0.0548,  0.0913]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
<p><code># 예제3</code> – 동영상분류</p>
<div id="cell-51" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> transformers.VideoMAEForVideoClassification.from_pretrained(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MCG-NJU/videomae-base"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of VideoMAEForVideoClassification were not initialized from the model checkpoint at MCG-NJU/videomae-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><em>모델의 기본정보(config)</em></p>
<div id="cell-53" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model3.config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>VideoMAEConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "MCG-NJU/videomae-base",
  "architectures": [
    "VideoMAEForPreTraining"
  ],
  "attention_probs_dropout_prob": 0.0,
  "decoder_hidden_size": 384,
  "decoder_intermediate_size": 1536,
  "decoder_num_attention_heads": 6,
  "decoder_num_hidden_layers": 4,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "videomae",
  "norm_pix_loss": true,
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_frames": 16,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "torch_dtype": "float32",
  "transformers_version": "4.46.2",
  "tubelet_size": 2,
  "use_mean_pooling": false
}</code></pre>
</div>
</div>
<ul>
<li>image_size: 224</li>
<li>num_frames: 16</li>
</ul>
<p><em>모델의 입력파악</em></p>
<div id="cell-56" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model3.forward?</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -- 결과가 너무 길어서 생략</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>사용예시1 – 입력나열, loss O</em></p>
<div id="cell-58" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>model3(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>ImageClassifierOutput(loss=tensor(0.7254, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.7084, -0.2919],
        [-0.5846, -0.1854],
        [-0.6635, -0.2402],
        [-0.7193, -0.3811]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시2 – <code>**딕셔너리</code>, loss O</em></p>
<div id="cell-60" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model3_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> torch.tensor([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>model3(<span class="op">**</span>model3_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>ImageClassifierOutput(loss=tensor(0.7254, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[-0.7084, -0.2919],
        [-0.5846, -0.1854],
        [-0.6635, -0.2402],
        [-0.7193, -0.3811]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시3 – 입력나열, loss X</em></p>
<div id="cell-62" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>model3(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.7084, -0.2919],
        [-0.5846, -0.1854],
        [-0.6635, -0.2402],
        [-0.7193, -0.3811]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시4 – <code>**딕셔너리</code>, loss X</em></p>
<div id="cell-64" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>model3_input <span class="op">=</span> <span class="bu">dict</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    pixel_values <span class="op">=</span> torch.randn(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>model3(<span class="op">**</span>model3_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.7084, -0.2919],
        [-0.5846, -0.1854],
        [-0.6635, -0.2402],
        [-0.7193, -0.3811]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><em>사용예시5 – 초간단, loss X</em></p>
<div id="cell-66" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>torch.random.manual_seed(<span class="dv">42</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model3(torch.randn(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.7084, -0.2919],
        [-0.5846, -0.1854],
        [-0.6635, -0.2402],
        [-0.7193, -0.3811]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
</section>
<section id="model-사용-연습" class="level1">
<h1>4. Model 사용 연습</h1>
<section id="a.-텍스트" class="level2">
<h2 class="anchored" data-anchor-id="a.-텍스트">A. 텍스트</h2>
<div id="cell-70" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> transformers.AutoModelForSequenceClassification.from_pretrained(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span>, num_labels<span class="op">=</span><span class="dv">2</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> transformers.AutoTokenizer.from_pretrained(<span class="st">"distilbert/distilbert-base-uncased"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert/distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code># 예제1</code> – imdb</p>
<div id="cell-72" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>imdb <span class="op">=</span> datasets.load_dataset(<span class="st">'imdb'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> imdb[<span class="st">'train'</span>].select(<span class="bu">range</span>(<span class="dv">3</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Dataset({
    features: ['text', 'label'],
    num_rows: 3
})</code></pre>
</div>
</div>
<p><code>(풀이1)</code></p>
<p><em>실패</em></p>
<div id="cell-76" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>model1.forward(torch.tensor(tokenizer(d[<span class="st">'text'</span>])[<span class="st">'input_ids'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: expected sequence of length 363 at dim 1 (got 304)</code></pre>
</div>
</div>
<p><em>원인분석</em></p>
<div id="cell-78" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mp.show_list(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    tokenizer(d[<span class="st">'text'</span>])[<span class="st">'input_ids'</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List Overview:
Total items: 3

1. list[0]
   - Type: list
   - Length: 363
   - Value: [101, 1045, 12524, 1045, 2572, 8025, 1011, 3756, 2013, 2026, 2678, 3573, 2138, 1997, 2035, 1996, 6704, 2008, 5129, 2009, 2043, 2009, 2001, 2034, 2207, 1999, 3476, 1012, 1045, 2036, 2657, 2008, 2012, 2034, 2009, 2001, 8243, 2011, 1057, 1012, 1055, 1012, 8205, 2065, 2009, 2412, 2699, 2000, 4607, 2023, 2406, 1010, 3568, 2108, 1037, 5470, 1997, 3152, 2641, 1000, 6801, 1000, 1045, 2428, 2018, 2000, 2156, 2023, 2005, 2870, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1996, 5436, 2003, 8857, 2105, 1037, 2402, 4467, 3689, 3076, 2315, 14229, 2040, 4122, 2000, 4553, 2673, 2016, 2064, 2055, 2166, 1012, 1999, 3327, 2016, 4122, 2000, 3579, 2014, 3086, 2015, 2000, 2437, 2070, 4066, 1997, 4516, 2006, 2054, 1996, 2779, 25430, 14728, 2245, 2055, 3056, 2576, 3314, 2107, 2004, 1996, 5148, 2162, 1998, 2679, 3314, 1999, 1996, 2142, 2163, 1012, 1999, 2090, 4851, 8801, 1998, 6623, 7939, 4697, 3619, 1997, 8947, 2055, 2037, 10740, 2006, 4331, 1010, 2016, 2038, 3348, 2007, 2014, 3689, 3836, 1010, 19846, 1010, 1998, 2496, 2273, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2054, 8563, 2033, 2055, 1045, 2572, 8025, 1011, 3756, 2003, 2008, 2871, 2086, 3283, 1010, 2023, 2001, 2641, 26932, 1012, 2428, 1010, 1996, 3348, 1998, 16371, 25469, 5019, 2024, 2261, 1998, 2521, 2090, 1010, 2130, 2059, 2009, 1005, 1055, 2025, 2915, 2066, 2070, 10036, 2135, 2081, 22555, 2080, 1012, 2096, 2026, 2406, 3549, 2568, 2424, 2009, 16880, 1010, 1999, 4507, 3348, 1998, 16371, 25469, 2024, 1037, 2350, 18785, 1999, 4467, 5988, 1012, 2130, 13749, 7849, 24544, 1010, 15835, 2037, 3437, 2000, 2204, 2214, 2879, 2198, 4811, 1010, 2018, 3348, 5019, 1999, 2010, 3152, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1045, 2079, 4012, 3549, 2094, 1996, 16587, 2005, 1996, 2755, 2008, 2151, 3348, 3491, 1999, 1996, 2143, 2003, 3491, 2005, 6018, 5682, 2738, 2084, 2074, 2000, 5213, 2111, 1998, 2191, 2769, 2000, 2022, 3491, 1999, 26932, 12370, 1999, 2637, 1012, 1045, 2572, 8025, 1011, 3756, 2003, 1037, 2204, 2143, 2005, 3087, 5782, 2000, 2817, 1996, 6240, 1998, 14629, 1006, 2053, 26136, 3832, 1007, 1997, 4467, 5988, 1012, 2021, 2428, 1010, 2023, 2143, 2987, 1005, 1056, 2031, 2172, 1997, 1037, 5436, 1012, 102]

2. list[1]
   - Type: list
   - Length: 304
   - Value: [101, 1000, 1045, 2572, 8025, 1024, 3756, 1000, 2003, 1037, 15544, 19307, 1998, 3653, 6528, 20771, 19986, 8632, 1012, 2009, 2987, 1005, 1056, 3043, 2054, 2028, 1005, 1055, 2576, 5328, 2024, 2138, 2023, 2143, 2064, 6684, 2022, 2579, 5667, 2006, 2151, 2504, 1012, 2004, 2005, 1996, 4366, 2008, 19124, 3287, 16371, 25469, 2003, 2019, 6882, 13316, 1011, 2459, 1010, 2008, 3475, 1005, 1056, 2995, 1012, 1045, 1005, 2310, 2464, 1054, 1011, 6758, 3152, 2007, 3287, 16371, 25469, 1012, 4379, 1010, 2027, 2069, 3749, 2070, 25085, 5328, 1010, 2021, 2073, 2024, 1996, 1054, 1011, 6758, 3152, 2007, 21226, 24728, 22144, 2015, 1998, 20916, 4691, 6845, 2401, 1029, 7880, 1010, 2138, 2027, 2123, 1005, 1056, 4839, 1012, 1996, 2168, 3632, 2005, 2216, 10231, 7685, 5830, 3065, 1024, 8040, 7317, 5063, 2015, 11820, 1999, 1996, 9478, 2021, 2025, 1037, 17962, 21239, 1999, 4356, 1012, 1998, 2216, 3653, 6528, 20771, 10271, 5691, 2066, 1996, 2829, 16291, 1010, 1999, 2029, 2057, 1005, 2128, 5845, 2000, 1996, 2609, 1997, 6320, 25624, 1005, 1055, 17061, 3779, 1010, 2021, 2025, 1037, 7637, 1997, 5061, 5710, 2006, 9318, 7367, 5737, 19393, 1012, 2077, 6933, 1006, 2030, 20242, 1007, 1000, 3313, 1011, 3115, 1000, 1999, 5609, 1997, 16371, 25469, 1010, 1996, 10597, 27885, 5809, 2063, 2323, 2202, 2046, 4070, 2028, 14477, 6767, 8524, 6321, 5793, 28141, 4489, 2090, 2273, 1998, 2308, 1024, 2045, 2024, 2053, 8991, 18400, 2015, 2006, 4653, 2043, 19910, 3544, 15287, 1010, 1998, 1996, 2168, 3685, 2022, 2056, 2005, 1037, 2158, 1012, 1999, 2755, 1010, 2017, 3227, 2180, 1005, 1056, 2156, 2931, 8991, 18400, 2015, 1999, 2019, 2137, 2143, 1999, 2505, 2460, 1997, 22555, 2030, 13216, 14253, 2050, 1012, 2023, 6884, 3313, 1011, 3115, 2003, 2625, 1037, 3313, 3115, 2084, 2019, 4914, 2135, 2139, 24128, 3754, 2000, 2272, 2000, 3408, 20547, 2007, 1996, 19008, 1997, 2308, 1005, 1055, 4230, 1012, 102]

3. list[2]
   - Type: list
   - Length: 133
   - Value: [101, 2065, 2069, 2000, 4468, 2437, 2023, 2828, 1997, 2143, 1999, 1996, 2925, 1012, 2023, 2143, 2003, 5875, 2004, 2019, 7551, 2021, 4136, 2053, 2522, 11461, 2466, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2028, 2453, 2514, 6819, 5339, 8918, 2005, 3564, 27046, 2009, 2138, 2009, 12817, 2006, 2061, 2116, 2590, 3314, 2021, 2009, 2515, 2061, 2302, 2151, 5860, 11795, 3085, 15793, 1012, 1996, 13972, 3310, 2185, 2007, 2053, 2047, 15251, 1006, 4983, 2028, 3310, 2039, 2007, 2028, 2096, 2028, 1005, 1055, 2568, 17677, 2015, 1010, 2004, 2009, 2097, 26597, 2079, 2076, 2023, 23100, 2143, 1007, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2028, 2453, 2488, 5247, 2028, 1005, 1055, 2051, 4582, 2041, 1037, 3332, 2012, 1037, 3392, 3652, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 102]</code></pre>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mp.show_list(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    tokenizer(d[<span class="st">'text'</span>], padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List Overview:
Total items: 3

1. list[0]
   - Type: list
   - Length: 363
   - Value: [101, 1045, 12524, 1045, 2572, 8025, 1011, 3756, 2013, 2026, 2678, 3573, 2138, 1997, 2035, 1996, 6704, 2008, 5129, 2009, 2043, 2009, 2001, 2034, 2207, 1999, 3476, 1012, 1045, 2036, 2657, 2008, 2012, 2034, 2009, 2001, 8243, 2011, 1057, 1012, 1055, 1012, 8205, 2065, 2009, 2412, 2699, 2000, 4607, 2023, 2406, 1010, 3568, 2108, 1037, 5470, 1997, 3152, 2641, 1000, 6801, 1000, 1045, 2428, 2018, 2000, 2156, 2023, 2005, 2870, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1996, 5436, 2003, 8857, 2105, 1037, 2402, 4467, 3689, 3076, 2315, 14229, 2040, 4122, 2000, 4553, 2673, 2016, 2064, 2055, 2166, 1012, 1999, 3327, 2016, 4122, 2000, 3579, 2014, 3086, 2015, 2000, 2437, 2070, 4066, 1997, 4516, 2006, 2054, 1996, 2779, 25430, 14728, 2245, 2055, 3056, 2576, 3314, 2107, 2004, 1996, 5148, 2162, 1998, 2679, 3314, 1999, 1996, 2142, 2163, 1012, 1999, 2090, 4851, 8801, 1998, 6623, 7939, 4697, 3619, 1997, 8947, 2055, 2037, 10740, 2006, 4331, 1010, 2016, 2038, 3348, 2007, 2014, 3689, 3836, 1010, 19846, 1010, 1998, 2496, 2273, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2054, 8563, 2033, 2055, 1045, 2572, 8025, 1011, 3756, 2003, 2008, 2871, 2086, 3283, 1010, 2023, 2001, 2641, 26932, 1012, 2428, 1010, 1996, 3348, 1998, 16371, 25469, 5019, 2024, 2261, 1998, 2521, 2090, 1010, 2130, 2059, 2009, 1005, 1055, 2025, 2915, 2066, 2070, 10036, 2135, 2081, 22555, 2080, 1012, 2096, 2026, 2406, 3549, 2568, 2424, 2009, 16880, 1010, 1999, 4507, 3348, 1998, 16371, 25469, 2024, 1037, 2350, 18785, 1999, 4467, 5988, 1012, 2130, 13749, 7849, 24544, 1010, 15835, 2037, 3437, 2000, 2204, 2214, 2879, 2198, 4811, 1010, 2018, 3348, 5019, 1999, 2010, 3152, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1045, 2079, 4012, 3549, 2094, 1996, 16587, 2005, 1996, 2755, 2008, 2151, 3348, 3491, 1999, 1996, 2143, 2003, 3491, 2005, 6018, 5682, 2738, 2084, 2074, 2000, 5213, 2111, 1998, 2191, 2769, 2000, 2022, 3491, 1999, 26932, 12370, 1999, 2637, 1012, 1045, 2572, 8025, 1011, 3756, 2003, 1037, 2204, 2143, 2005, 3087, 5782, 2000, 2817, 1996, 6240, 1998, 14629, 1006, 2053, 26136, 3832, 1007, 1997, 4467, 5988, 1012, 2021, 2428, 1010, 2023, 2143, 2987, 1005, 1056, 2031, 2172, 1997, 1037, 5436, 1012, 102]

2. list[1]
   - Type: list
   - Length: 363
   - Value: [101, 1000, 1045, 2572, 8025, 1024, 3756, 1000, 2003, 1037, 15544, 19307, 1998, 3653, 6528, 20771, 19986, 8632, 1012, 2009, 2987, 1005, 1056, 3043, 2054, 2028, 1005, 1055, 2576, 5328, 2024, 2138, 2023, 2143, 2064, 6684, 2022, 2579, 5667, 2006, 2151, 2504, 1012, 2004, 2005, 1996, 4366, 2008, 19124, 3287, 16371, 25469, 2003, 2019, 6882, 13316, 1011, 2459, 1010, 2008, 3475, 1005, 1056, 2995, 1012, 1045, 1005, 2310, 2464, 1054, 1011, 6758, 3152, 2007, 3287, 16371, 25469, 1012, 4379, 1010, 2027, 2069, 3749, 2070, 25085, 5328, 1010, 2021, 2073, 2024, 1996, 1054, 1011, 6758, 3152, 2007, 21226, 24728, 22144, 2015, 1998, 20916, 4691, 6845, 2401, 1029, 7880, 1010, 2138, 2027, 2123, 1005, 1056, 4839, 1012, 1996, 2168, 3632, 2005, 2216, 10231, 7685, 5830, 3065, 1024, 8040, 7317, 5063, 2015, 11820, 1999, 1996, 9478, 2021, 2025, 1037, 17962, 21239, 1999, 4356, 1012, 1998, 2216, 3653, 6528, 20771, 10271, 5691, 2066, 1996, 2829, 16291, 1010, 1999, 2029, 2057, 1005, 2128, 5845, 2000, 1996, 2609, 1997, 6320, 25624, 1005, 1055, 17061, 3779, 1010, 2021, 2025, 1037, 7637, 1997, 5061, 5710, 2006, 9318, 7367, 5737, 19393, 1012, 2077, 6933, 1006, 2030, 20242, 1007, 1000, 3313, 1011, 3115, 1000, 1999, 5609, 1997, 16371, 25469, 1010, 1996, 10597, 27885, 5809, 2063, 2323, 2202, 2046, 4070, 2028, 14477, 6767, 8524, 6321, 5793, 28141, 4489, 2090, 2273, 1998, 2308, 1024, 2045, 2024, 2053, 8991, 18400, 2015, 2006, 4653, 2043, 19910, 3544, 15287, 1010, 1998, 1996, 2168, 3685, 2022, 2056, 2005, 1037, 2158, 1012, 1999, 2755, 1010, 2017, 3227, 2180, 1005, 1056, 2156, 2931, 8991, 18400, 2015, 1999, 2019, 2137, 2143, 1999, 2505, 2460, 1997, 22555, 2030, 13216, 14253, 2050, 1012, 2023, 6884, 3313, 1011, 3115, 2003, 2625, 1037, 3313, 3115, 2084, 2019, 4914, 2135, 2139, 24128, 3754, 2000, 2272, 2000, 3408, 20547, 2007, 1996, 19008, 1997, 2308, 1005, 1055, 4230, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

3. list[2]
   - Type: list
   - Length: 363
   - Value: [101, 2065, 2069, 2000, 4468, 2437, 2023, 2828, 1997, 2143, 1999, 1996, 2925, 1012, 2023, 2143, 2003, 5875, 2004, 2019, 7551, 2021, 4136, 2053, 2522, 11461, 2466, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2028, 2453, 2514, 6819, 5339, 8918, 2005, 3564, 27046, 2009, 2138, 2009, 12817, 2006, 2061, 2116, 2590, 3314, 2021, 2009, 2515, 2061, 2302, 2151, 5860, 11795, 3085, 15793, 1012, 1996, 13972, 3310, 2185, 2007, 2053, 2047, 15251, 1006, 4983, 2028, 3310, 2039, 2007, 2028, 2096, 2028, 1005, 1055, 2568, 17677, 2015, 1010, 2004, 2009, 2097, 26597, 2079, 2076, 2023, 23100, 2143, 1007, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2028, 2453, 2488, 5247, 2028, 1005, 1055, 2051, 4582, 2041, 1037, 3332, 2012, 1037, 3392, 3652, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</code></pre>
</div>
</div>
<p><em>성공</em></p>
<div id="cell-81" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>model1(torch.tensor(tokenizer(d[<span class="st">'text'</span>], padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0174,  0.1774],
        [-0.0269,  0.2127],
        [-0.0322,  0.2528]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(풀이2)</code></p>
<div id="cell-83" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>model1(tokenizer(d[<span class="st">'text'</span>], padding<span class="op">=</span><span class="va">True</span>, return_tensors<span class="op">=</span><span class="st">"pt"</span>)[<span class="st">'input_ids'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0174,  0.1774],
        [-0.0269,  0.2127],
        [-0.0322,  0.2528]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
<p><code># 예제2</code> – emotion</p>
<div id="cell-86" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>emotion <span class="op">=</span> datasets.load_dataset(<span class="st">'emotion'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-87" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> emotion[<span class="st">'train'</span>].select(<span class="bu">range</span>(<span class="dv">3</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>Dataset({
    features: ['text', 'label'],
    num_rows: 3
})</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-89" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>model1(torch.tensor(tokenizer(d[<span class="st">'text'</span>],padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[0.0163, 0.2285],
        [0.0100, 0.2066],
        [0.0087, 0.2619]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
<p><code># 예제3</code> – MBTI</p>
<div id="cell-92" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mbti1.csv 파일 다운로드 </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>guebin<span class="op">/</span>MP2024<span class="op">/</span>refs<span class="op">/</span>heads<span class="op">/</span>main<span class="op">/</span>posts<span class="op">/</span>mbti_1.csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
    - Avoid using `tokenizers` before the fork if possible
    - Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--2024-11-15 19:18:39--  https://raw.githubusercontent.com/guebin/MP2024/refs/heads/main/posts/mbti_1.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.111.133, 185.199.108.133, 185.199.109.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.111.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 62856486 (60M) [text/plain]
Saving to: ‘mbti_1.csv.1’

mbti_1.csv.1        100%[===================&gt;]  59.94M   107MB/s    in 0.6s    

2024-11-15 19:18:44 (107 MB/s) - ‘mbti_1.csv.1’ saved [62856486/62856486]
</code></pre>
</div>
</div>
<div id="cell-93" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> datasets.Dataset.from_csv(<span class="st">"mbti_1.csv"</span>).select(<span class="bu">range</span>(<span class="dv">3</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Generating train split: 8675 examples [00:00, 16512.48 examples/s]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>Dataset({
    features: ['type', 'posts'],
    num_rows: 3
})</code></pre>
</div>
</div>
<p><code>(풀이1)</code></p>
<p><em>실패</em></p>
<div id="cell-96" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>model1(torch.tensor(tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Token indices sequence length is longer than the specified maximum sequence length for this model (2102 &gt; 512). Running this sequence through the model will result in indexing errors</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>RuntimeError: The size of tensor a (2102) must match the size of tensor b (512) at non-singleton dimension 1</code></pre>
</div>
</div>
<p><em>원인분석</em></p>
<div id="cell-98" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>mp.show_list(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List Overview:
Total items: 3

1. list[0]
   - Type: list
   - Length: 2102
   - Value: [101, 1005, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1053, 2015, 2595, 16257, 8545, 2509, 21638, 2860, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 4601, 1012, 2865, 1012, 10722, 14905, 20974, 1012, 4012, 1013, 10722, 14905, 20974, 1035, 1048, 14876, 26230, 2692, 2509, 9737, 27717, 19062, 2487, 3217, 9541, 2487, 1035, 3156, 1012, 16545, 2290, 1064, 1064, 1064, 4372, 22540, 1998, 20014, 3501, 5312, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1045, 2480, 2581, 2571, 2487, 2290, 2549, 2595, 2213, 2549, 2998, 13013, 2121, 2025, 2327, 2702, 3248, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 15384, 20952, 4371, 2487, 12870, 2278, 26418, 2015, 1064, 1064, 1064, 2054, 2038, 2042, 1996, 2087, 2166, 1011, 5278, 3325, 1999, 2115, 2166, 1029, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1058, 2595, 4371, 2100, 2860, 13088, 2094, 2860, 2620, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1057, 2620, 20518, 3286, 2629, 18927, 2509, 2063, 2006, 9377, 2005, 2087, 1997, 2651, 1012, 1064, 1064, 1064, 2089, 1996, 2566, 2278, 3325, 10047, 16862, 2063, 2017, 1012, 1064, 1064, 1064, 1996, 2197, 2518, 2026, 1999, 2546, 3501, 2767, 6866, 2006, 2010, 9130, 2077, 16873, 5920, 1996, 2279, 2154, 1012, 2717, 1999, 3521, 1066, 8299, 1024, 1013, 1013, 6819, 26247, 1012, 4012, 1013, 22238, 20958, 11387, 2575, 1064, 1064, 1064, 7592, 4372, 2546, 3501, 2581, 1012, 3374, 2000, 2963, 1997, 2115, 12893, 1012, 2009, 1005, 1055, 2069, 3019, 2005, 1037, 3276, 2000, 2025, 2022, 15401, 2035, 1996, 2051, 1999, 2296, 2617, 1997, 4598, 1012, 3046, 2000, 3275, 1996, 2524, 2335, 2004, 2335, 1997, 3930, 1010, 2004, 1012, 1012, 1012, 1064, 1064, 1064, 6391, 22025, 2683, 6391, 23499, 2692, 8299, 1024, 1013, 1013, 2813, 23298, 15194, 3258, 1012, 4012, 1013, 2039, 11066, 1013, 23297, 8889, 1013, 6860, 1011, 2879, 1011, 1998, 1011, 2611, 1011, 2813, 23298, 1012, 16545, 2290, 8299, 1024, 1013, 1013, 7045, 1012, 2079, 19139, 2497, 1012, 4012, 1013, 1059, 2361, 1011, 4180, 1013, 2039, 11066, 2015, 1013, 2230, 1013, 5840, 1013, 2461, 1011, 2188, 1011, 2640, 1012, 16545, 2290, 1012, 1012, 1012, 1064, 1064, 1064, 6160, 1998, 4933, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 2447, 7971, 10127, 1012, 4012, 1013, 1059, 2361, 1011, 4180, 1013, 2039, 11066, 2015, 1013, 2286, 1013, 5511, 1013, 2417, 1011, 2417, 1011, 1996, 1011, 20421, 1011, 3040, 1011, 19652, 16086, 22610, 2549, 1011, 10332, 1011, 27908, 1012, 16545, 2290, 2208, 1012, 2275, 1012, 2674, 1012, 1064, 1064, 1064, 4013, 4143, 2278, 1010, 2092, 19892, 21823, 2078, 1010, 2012, 2560, 4228, 2781, 1997, 3048, 2115, 3456, 1006, 1998, 1045, 2123, 1005, 1056, 2812, 3048, 2068, 2096, 3564, 1999, 2115, 2168, 4624, 3242, 1007, 1010, 17901, 1999, 5549, 8156, 1006, 2672, 3046, 21006, 2015, 2004, 1037, 2740, 3771, 4522, 1012, 1012, 1012, 1064, 1064, 1064, 10468, 2272, 2039, 2007, 2093, 5167, 2017, 1005, 2310, 4340, 2008, 2169, 2828, 1006, 2030, 29221, 4127, 2017, 2215, 2000, 2079, 1007, 2052, 2062, 2084, 3497, 2224, 1010, 2445, 2169, 4127, 1005, 10699, 4972, 1998, 2054, 17048, 1010, 2043, 2187, 2011, 1012, 1012, 1012, 1064, 1064, 1064, 2035, 2477, 1999, 5549, 8156, 1012, 18135, 2003, 5262, 1037, 2678, 2208, 1010, 1998, 1037, 2204, 2028, 2012, 2008, 1012, 3602, 1024, 1037, 2204, 2028, 2012, 2008, 2003, 5399, 20714, 1999, 2008, 1045, 2572, 2025, 3294, 7694, 1996, 2331, 1997, 2151, 2445, 21934, 1012, 1012, 1012, 1064, 1064, 1064, 6203, 4372, 22540, 1024, 2054, 2020, 2115, 5440, 2678, 2399, 3652, 2039, 1998, 2054, 2024, 2115, 2085, 1010, 2783, 5440, 2678, 2399, 1029, 1024, 4658, 1024, 1064, 1064, 1064, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1053, 22571, 4160, 2102, 2620, 2819, 2480, 8029, 1064, 1064, 1064, 2009, 3544, 2000, 2022, 2205, 2397, 1012, 1024, 6517, 1024, 1064, 1064, 1064, 2045, 1005, 1055, 2619, 2041, 2045, 2005, 3071, 1012, 1064, 1064, 1064, 3524, 1012, 1012, 1012, 1045, 2245, 7023, 2001, 1037, 2204, 2518, 1012, 1064, 1064, 1064, 1045, 2074, 24188, 4509, 1996, 2051, 1997, 22560, 1038, 1013, 1039, 1045, 7065, 2884, 2306, 2026, 5110, 2088, 2062, 6168, 2087, 2060, 2051, 1045, 1005, 1040, 2022, 2147, 2378, 1012, 1012, 1012, 2074, 5959, 1996, 2033, 2051, 2096, 2017, 2064, 1012, 2123, 1005, 1056, 4737, 1010, 2111, 2097, 2467, 2022, 2105, 2000, 1012, 1012, 1012, 1064, 1064, 1064, 10930, 4372, 25856, 6456, 1012, 1012, 1012, 2065, 2017, 1005, 2128, 2046, 1037, 19394, 5649, 6180, 1010, 2092, 1010, 4931, 1012, 1064, 1064, 1064, 1012, 1012, 1012, 2043, 2115, 2364, 2591, 13307, 2003, 12202, 2444, 11450, 1998, 2130, 2059, 2017, 12064, 2135, 16342, 2855, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1043, 16425, 2100, 2581, 4103, 16715, 16932, 1045, 2428, 10667, 1996, 2112, 2013, 1015, 1024, 4805, 2000, 1016, 1024, 2753, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 5796, 4160, 2595, 4246, 5603, 2581, 2497, 2620, 1064, 1064, 1064, 7917, 2138, 2023, 11689, 5942, 2009, 1997, 2033, 1012, 1064, 1064, 1064, 2131, 2152, 1999, 16125, 1010, 25043, 1998, 4521, 9409, 10199, 8261, 2015, 1999, 16125, 2096, 9530, 14028, 2075, 2058, 2242, 7789, 1010, 2628, 2011, 21881, 2015, 1998, 8537, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 12464, 2581, 8780, 2226, 2509, 25526, 4783, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1018, 2615, 2475, 26230, 2953, 2232, 4160, 6559, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 22889, 2615, 24798, 2546, 4160, 4160, 2692, 3775, 1064, 1064, 1064, 7917, 2005, 2205, 2116, 1038, 1005, 1055, 1999, 2008, 6251, 1012, 2129, 2071, 2017, 999, 2228, 1997, 1996, 1038, 999, 1064, 1064, 1064, 7917, 2005, 3666, 5691, 1999, 1996, 3420, 2007, 1996, 24654, 9623, 1012, 1064, 1064, 1064, 7917, 2138, 2740, 2465, 4415, 4036, 2017, 2498, 2055, 8152, 3778, 1012, 1064, 1064, 1064, 7917, 2005, 1037, 2878, 3677, 1997, 4436, 999, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 20868, 26775, 2615, 23632, 25619, 2480, 2549, 1064, 1064, 1064, 1015, 1007, 2048, 3336, 8448, 2006, 2187, 1998, 2157, 14163, 12680, 2075, 2006, 1037, 7813, 1999, 1996, 2690, 1012, 1016, 1007, 2478, 2037, 2219, 2668, 1010, 2048, 5430, 3549, 9708, 2651, 1005, 1055, 6745, 6230, 2015, 2006, 2037, 4351, 5430, 9708, 2813, 1012, 1017, 1007, 1045, 2156, 2009, 2004, 1012, 1012, 1012, 1064, 1064, 1064, 1037, 20421, 2088, 2019, 1999, 2546, 3501, 2554, 3071, 4150, 2019, 23569, 27605, 3367, 1064, 1064, 1064, 4749, 16932, 2475, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1062, 19170, 4160, 1035, 1046, 7959, 16715, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7523, 2863, 3654, 21254, 1012, 4012, 1013, 2262, 1013, 21650, 1011, 15476, 1013, 2322, 1011, 2477, 1011, 2017, 1011, 2134, 2102, 1011, 2113, 1011, 2055, 1011, 28858, 1013, 5532, 1012, 16545, 2290, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 21480, 1012, 16270, 5714, 5620, 1012, 4012, 1013, 2865, 9148, 3211, 1013, 17928, 2015, 1012, 16270, 1012, 4012, 1013, 20421, 1011, 3165, 1011, 2544, 1013, 1040, 1013, 20315, 1013, 4487, 9284, 1012, 21025, 2546, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 14262, 15878, 6137, 1012, 5658, 1013, 8962, 2860, 1011, 1040, 2361, 1013, 16596, 6844, 2099, 1012, 16545, 2290, 1064, 1064, 1064, 2025, 2035, 3324, 2024, 3324, 2138, 2027, 4009, 1012, 2009, 1005, 1055, 1996, 2801, 2008, 9294, 1999, 5716, 2242, 1997, 2115, 2219, 1012, 1012, 1012, 2066, 1037, 8085, 1012, 1064, 1064, 1064, 6160, 2000, 1996, 8957, 6938, 1010, 2711, 2040, 20164, 2026, 2969, 1011, 19593, 12731, 2480, 1045, 1005, 1049, 2025, 2019, 18568, 8085, 3063, 2066, 2841, 1012, 1024, 7098, 1024, 1064, 1064, 1064, 7917, 2005, 2635, 2035, 1996, 2282, 2104, 2026, 2793, 1012, 8038, 10657, 4553, 2000, 3745, 2007, 1996, 20997, 2229, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1059, 2620, 8004, 5714, 2078, 28311, 20784, 1064, 1064, 1064, 7917, 2005, 2108, 2205, 2172, 1997, 1037, 8505, 2075, 1010, 24665, 25438, 2989, 2785, 1997, 4040, 1012, 1012, 1012, 15624, 1012, 1064, 1064, 1064, 6289, 2232, 1012, 1012, 1012, 2214, 2152, 2082, 2189, 1045, 4033, 1005, 1056, 2657, 1999, 5535, 1012, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 5887, 26775, 6279, 19797, 2497, 2487, 2860, 1064, 1064, 1064, 1045, 3478, 1037, 2270, 4092, 2465, 1037, 2261, 2086, 3283, 1998, 1045, 1005, 2310, 4066, 1997, 4342, 2054, 1045, 2071, 2079, 2488, 2020, 1045, 2000, 2022, 1999, 2008, 2597, 2153, 1012, 1037, 2502, 2112, 1997, 2026, 4945, 2001, 2074, 2058, 18570, 2870, 2007, 2205, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 2066, 2023, 2711, 1005, 1055, 5177, 3012, 1012, 2002, 1005, 1055, 1037, 4484, 20014, 3501, 2011, 1996, 2126, 1012, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1044, 2290, 2243, 3669, 1011, 16216, 2278, 2575, 2213, 1064, 1064, 1064, 2693, 2000, 1996, 7573, 2181, 1998, 2707, 1037, 2047, 2166, 2005, 2870, 1012, 1005, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

2. list[1]
   - Type: list
   - Length: 2102
   - Value: [101, 1005, 1045, 1005, 1049, 4531, 1996, 3768, 1997, 2033, 1999, 2122, 8466, 2200, 8598, 2075, 1012, 1064, 1064, 1064, 3348, 2064, 2022, 11771, 2065, 2009, 1005, 1055, 1999, 1996, 2168, 2597, 2411, 1012, 2005, 2742, 2033, 1998, 2026, 6513, 2024, 2747, 1999, 2019, 4044, 2073, 2057, 2031, 2000, 5541, 2135, 2224, 11190, 15239, 1998, 8696, 1012, 2045, 3475, 1005, 1056, 2438, 1012, 1012, 1012, 1064, 1064, 1064, 3228, 2047, 3574, 2000, 1005, 2208, 1005, 3399, 1012, 1064, 1064, 1064, 7592, 1008, 4372, 25856, 5861, 1008, 2008, 1005, 1055, 2035, 2009, 3138, 1012, 2084, 2057, 23705, 1998, 2027, 2079, 2087, 1997, 1996, 20661, 2096, 1045, 13399, 2037, 3739, 1998, 2709, 2037, 2616, 2007, 5744, 2773, 13068, 1998, 2062, 5048, 2100, 20237, 1012, 1064, 1064, 1064, 2023, 1009, 3768, 1997, 5703, 1998, 2192, 3239, 12016, 1012, 1064, 1064, 1064, 2613, 26264, 3231, 1045, 3556, 13029, 1012, 4274, 26264, 5852, 2024, 6057, 1012, 1045, 3556, 8574, 2015, 2030, 3020, 1012, 2085, 1010, 2066, 1996, 2280, 10960, 1997, 2023, 11689, 1045, 2097, 5254, 2008, 1045, 2123, 1005, 1056, 2903, 1999, 1996, 26264, 3231, 1012, 2077, 2017, 7221, 4509, 1012, 1012, 1012, 1064, 1064, 1064, 2017, 2113, 2017, 1005, 2128, 2019, 4372, 25856, 2043, 2017, 25887, 2013, 1037, 2609, 2005, 1037, 2095, 1998, 1037, 2431, 1010, 2709, 1010, 1998, 2424, 2111, 2024, 2145, 15591, 2006, 2115, 8466, 1998, 16663, 2115, 4784, 1013, 4301, 1012, 2017, 2113, 2017, 1005, 2128, 2019, 4372, 25856, 2043, 2017, 1012, 1012, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 10047, 2290, 15136, 2620, 1012, 4871, 3270, 3600, 1012, 2149, 1013, 10047, 2290, 15136, 2620, 1013, 4185, 19317, 1013, 3438, 11387, 2094, 2487, 2546, 2683, 2850, 2575, 2683, 22932, 2050, 2575, 2497, 2581, 2487, 19473, 2575, 1012, 16545, 2290, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 10047, 2290, 1012, 4639, 2094, 16872, 28014, 1012, 4012, 1013, 6282, 2509, 2050, 2692, 2278, 2575, 18827, 22025, 16932, 3540, 2497, 2620, 2549, 2278, 22203, 1064, 1064, 1064, 1045, 2058, 2228, 2477, 2823, 1012, 1045, 2175, 2011, 1996, 2214, 20052, 9106, 14686, 1012, 3383, 1010, 2043, 1037, 2158, 2038, 2569, 3716, 1998, 2569, 4204, 2066, 2026, 2219, 1010, 2009, 2738, 16171, 2032, 2000, 6148, 1037, 3375, 1012, 1012, 1012, 1064, 1064, 1064, 13789, 12155, 10270, 1012, 10722, 14905, 20974, 1012, 4012, 2061, 2003, 1045, 1024, 1040, 1064, 1064, 1064, 4278, 1010, 2199, 1009, 2695, 1064, 1064, 1064, 2025, 2428, 1025, 1045, 1005, 2310, 2196, 2245, 1997, 1041, 1013, 1045, 2030, 1046, 1013, 1052, 2004, 2613, 4972, 1012, 1045, 3648, 2870, 2006, 2054, 1045, 2224, 1012, 1045, 2224, 11265, 1998, 14841, 2004, 2026, 29532, 1012, 10768, 2005, 6699, 1998, 6524, 9033, 1012, 1045, 2036, 2224, 9152, 2349, 2000, 2033, 3997, 1012, 1012, 1012, 1064, 1064, 1064, 2017, 2113, 2295, 1012, 2008, 2001, 13749, 18595, 3560, 1012, 2044, 3038, 2009, 1045, 2428, 2215, 2000, 3046, 2009, 1998, 2156, 2054, 6433, 2007, 2033, 2652, 1037, 2034, 2711, 13108, 1999, 1996, 2067, 2096, 2057, 3298, 2105, 1012, 1045, 2215, 2000, 2156, 1996, 2298, 2006, 1012, 1012, 1012, 1064, 1064, 1064, 2041, 1997, 2035, 1997, 2068, 1996, 2600, 3259, 2028, 2003, 1996, 2190, 1012, 2009, 3084, 2033, 8840, 2140, 1012, 2017, 4364, 2024, 5341, 1024, 1040, 1045, 1005, 1049, 2428, 2152, 2039, 2006, 1996, 10722, 14905, 20974, 2291, 1012, 1064, 1064, 1064, 2061, 2106, 2017, 2963, 2055, 2008, 2047, 2034, 2711, 13108, 2208, 1029, 1045, 1005, 2310, 2042, 14934, 1996, 3109, 2041, 1997, 1996, 6050, 2006, 2026, 8285, 2614, 3941, 2008, 2097, 6073, 1996, 17223, 1012, 2057, 3266, 2000, 2404, 1037, 3232, 8827, 2509, 1005, 1055, 1999, 1012, 1012, 1012, 1064, 1064, 1064, 2053, 1025, 1996, 2126, 2002, 4198, 2477, 2001, 2200, 11265, 1012, 11265, 29532, 2024, 2074, 2004, 5204, 1997, 2037, 10058, 2004, 7367, 29532, 1012, 2742, 1024, 13218, 7084, 2030, 4754, 4869, 1025, 2119, 4372, 25856, 2015, 1012, 1064, 1064, 1064, 2092, 4918, 1045, 2097, 2022, 1996, 2034, 2000, 6449, 1045, 2079, 2131, 9981, 2066, 2017, 2079, 1012, 1045, 16833, 2009, 2039, 2000, 2026, 1018, 2860, 2509, 2540, 3816, 2007, 2026, 16083, 1021, 2860, 2620, 1012, 1021, 2015, 1998, 1022, 2015, 2119, 2066, 2000, 2022, 4384, 1012, 1018, 1005, 1055, 2066, 2000, 2022, 2124, 1006, 2025, 1996, 2168, 1012, 1012, 1012, 1064, 1064, 1064, 1025, 1040, 1045, 1005, 2222, 2039, 11066, 1996, 2168, 12528, 2007, 1996, 23025, 2185, 2013, 2026, 2677, 1012, 2084, 2017, 2180, 1005, 1056, 2963, 2505, 1012, 14104, 12025, 2806, 2021, 2007, 11867, 20051, 3334, 1012, 1064, 1064, 1064, 14841, 2243, 2000, 2243, 2003, 1037, 2428, 2307, 2299, 1012, 2004, 2146, 2004, 2017, 2064, 5177, 3796, 2041, 1996, 3220, 1012, 1045, 2293, 1996, 3786, 2009, 3084, 2033, 17523, 1012, 1064, 1064, 1064, 4530, 1012, 22834, 1058, 2487, 26760, 3600, 2692, 1024, 1040, 23025, 2428, 2485, 2000, 2026, 2677, 1998, 15488, 23212, 2078, 20232, 1024, 18364, 3608, 2652, 1999, 1996, 4281, 1012, 1064, 1064, 1064, 27084, 19210, 1027, 1013, 1027, 4654, 13181, 16874, 1025, 1045, 1005, 1049, 2019, 4654, 13181, 16874, 1998, 1045, 1005, 1049, 2025, 27084, 19210, 1012, 1024, 1007, 1064, 1064, 1064, 20052, 1999, 1996, 3185, 2001, 2019, 4372, 25856, 1012, 5373, 2002, 1005, 1055, 2209, 2004, 1037, 4654, 2102, 3501, 1012, 1999, 1996, 2808, 2002, 1005, 1055, 2019, 9765, 3501, 1012, 2004, 1045, 2056, 1012, 1996, 3185, 2246, 2204, 3272, 2005, 2009, 2108, 2170, 20052, 9106, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 6530, 10105, 2818, 1012, 1052, 3070, 1064, 1064, 1064, 2821, 1010, 1045, 2196, 2018, 3571, 1997, 7618, 1037, 3124, 1012, 1045, 2097, 3610, 2019, 4111, 2205, 1012, 2061, 2045, 2001, 2498, 2000, 25887, 1012, 2074, 3167, 5510, 1998, 2033, 2025, 16663, 2009, 1012, 1996, 3124, 1045, 4782, 2134, 1005, 1056, 2113, 2033, 1012, 2009, 2001, 2028, 1997, 2216, 1012, 1012, 1012, 1064, 1064, 1064, 4165, 3492, 2172, 2066, 2026, 2181, 1998, 2054, 1045, 1005, 1049, 2183, 2083, 2157, 2085, 2667, 2000, 3275, 2041, 2029, 2126, 1045, 2215, 2000, 2202, 2026, 2166, 1012, 1045, 2215, 2000, 2079, 2061, 2116, 2477, 1012, 1996, 5221, 3291, 2003, 2008, 1045, 2113, 2065, 1045, 2123, 1005, 1056, 1012, 1012, 1012, 1064, 1064, 1064, 1025, 1040, 1045, 2001, 4082, 2104, 1996, 8605, 2008, 2017, 2020, 2931, 1012, 1045, 2196, 2246, 2012, 2115, 3482, 2100, 1012, 3100, 1010, 1045, 2393, 2041, 2026, 5637, 2814, 2035, 1996, 2051, 1998, 2028, 1997, 2068, 2038, 2764, 1037, 2210, 10188, 2006, 2033, 1012, 1045, 2131, 2417, 1012, 1012, 1012, 1064, 1064, 1064, 1056, 1035, 1056, 2017, 2074, 2649, 2033, 1998, 1045, 1005, 1049, 2542, 1996, 5409, 10103, 1012, 1045, 1005, 1049, 7567, 1999, 2028, 2173, 2007, 2028, 2028, 2105, 1012, 2069, 10634, 5249, 1012, 2065, 1045, 2001, 1037, 7642, 6359, 2023, 2052, 2022, 1996, 3819, 2173, 2021, 13718, 1045, 1005, 1049, 1012, 1012, 1012, 1064, 1064, 1064, 26419, 2232, 1010, 1998, 25352, 1010, 4165, 2066, 1037, 25843, 1999, 22540, 1012, 1045, 2228, 2672, 2002, 2001, 3480, 1998, 2357, 9765, 3501, 1012, 1045, 2064, 2425, 2138, 2002, 2038, 2070, 1997, 1996, 5171, 1999, 22540, 12955, 2187, 2058, 1012, 1064, 1064, 1064, 1008, 14148, 2862, 1008, 1045, 1005, 1049, 3374, 1012, 2009, 3849, 2008, 2017, 2031, 2234, 2012, 1037, 2919, 2051, 1012, 2057, 1005, 2310, 2525, 2584, 2256, 20563, 1997, 1999, 2546, 22578, 1012, 2174, 1010, 2108, 2017, 1005, 2128, 2931, 1998, 1045, 2066, 3801, 1045, 2097, 2191, 2017, 1037, 3066, 1012, 1045, 2097, 5926, 2028, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 1005, 1049, 14405, 2361, 1006, 6729, 2646, 1041, 1007, 1012, 1045, 1005, 1049, 3733, 2005, 2119, 4372, 25856, 2015, 1998, 20014, 4523, 2000, 6709, 2007, 1012, 1024, 1007, 1064, 1064, 1064, 1045, 2036, 5674, 4372, 25856, 1005, 1055, 16871, 2015, 2052, 2175, 1037, 2210, 2978, 2066, 2990, 1005, 1055, 2013, 2484, 3272, 2062, 6228, 1012, 19838, 4726, 2039, 5213, 3949, 3941, 1999, 2019, 4704, 2311, 2041, 1997, 2019, 2214, 2482, 7151, 3723, 1010, 21097, 1012, 1012, 1012, 1064, 1064, 1064, 2009, 2001, 1037, 19394, 1024, 1007, 3404, 2033, 1012, 1045, 1005, 1049, 2074, 2004, 18224, 25940, 1024, 1040, 3272, 1045, 2031, 7861, 20214, 5644, 1012, 2027, 1005, 2128, 2074, 6881, 3924, 1012, 2066, 5870, 2043, 1045, 2131, 3480, 2030, 2012, 2111, 2770, 3209, 2058, 2007, 2037, 10168, 9587, 13777, 1012, 1012, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 8505, 19718, 1012, 1052, 3070, 11039, 25856, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 8505, 19718, 2497, 2860, 1012, 1052, 3070, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 14448, 19718, 1012, 1052, 3070, 1064, 1064, 1064, 2053, 1012, 2009, 1005, 1055, 2066, 1037, 4323, 2005, 2073, 1045, 2444, 1998, 2008, 2003, 2339, 1045, 2113, 2009, 2011, 2540, 1012, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1046, 2629, 2860, 2581, 2509, 3270, 2615, 4160, 2497, 2290, 1064, 1064, 1064, 1998, 1045, 5156, 2123, 1005, 1056, 2681, 2127, 1996, 2518, 4515, 1012, 2021, 1999, 1996, 2812, 2051, 1012, 1999, 2090, 2335, 1012, 2017, 2147, 2115, 2518, 1012, 1045, 1005, 2222, 2147, 3067, 1024, 1040, 1025, 1040, 1045, 1005, 1049, 1996, 16914, 2361, 1025, 5165, 2000, 3113, 2017, 1012, 1064, 1064, 1064, 4365, 1010, 2342, 2000, 3404, 2026, 16160, 2062, 1045, 2052, 2031, 2042, 3553, 1045, 2001, 2183, 2000, 2360, 1999, 22540, 1012, 1064, 1064, 1064, 4654, 22540, 1029, 6729, 2646, 1055, 2007, 1996, 2126, 2016, 5838, 1012, 1024, 1040, 2026, 2814, 1010, 2130, 2026, 5637, 1998, 11690, 3924, 1010, 2467, 2272, 2000, 2033, 2005, 6040, 1012, 1064, 1064, 1064, 1045, 6812, 2000, 2026, 4372, 25856, 5972, 4372, 25856, 2015, 2024, 2061, 2307, 1012, 2065, 2009, 2347, 1005, 1056, 2005, 4372, 25856, 2015, 1045, 2876, 1005, 1056, 2031, 2042, 2583, 2000, 3857, 2054, 1045, 1005, 1049, 2311, 9457, 9457, 9457, 13305, 1064, 1064, 1064, 2054, 1029, 2033, 1029, 1045, 2196, 2079, 2008, 1028, 1012, 1028, 1026, 1012, 1026, 1064, 1064, 1064, 2138, 2049, 2524, 2000, 2022, 6517, 2055, 3974, 2619, 2017, 2066, 2043, 2017, 2354, 2017, 2020, 2157, 1998, 2507, 4426, 1037, 2502, 6986, 2006, 1996, 2067, 2138, 2017, 1005, 2128, 12476, 1998, 2467, 6149, 1012, 1064, 1064, 1064, 2821, 1010, 2017, 2123, 1005, 1056, 2031, 2000, 2425, 2033, 2008, 2087, 1997, 2068, 2024, 5236, 1012, 1045, 2113, 2023, 1012, 2008, 2003, 2339, 1045, 2377, 2007, 2068, 1998, 2009, 3084, 2033, 4756, 1012, 1024, 1040, 2004, 1045, 1005, 1049, 2183, 2000, 2202, 11265, 10976, 18075, 9905, 6483, 1998, 1045, 2031, 1037, 2261, 15034, 1012, 1012, 1012, 1064, 1064, 1064, 1024, 1040, 1045, 1005, 1049, 1037, 2305, 5004, 2140, 1012, 1045, 5256, 2039, 2090, 1020, 1011, 1021, 9737, 1998, 2994, 8300, 6229, 2184, 1011, 2340, 1024, 2382, 3286, 1012, 1064, 1064, 1064, 3167, 5448, 6153, 2011, 3399, 2052, 6592, 2008, 20014, 4523, 2024, 1996, 2087, 14286, 3697, 1012, 2096, 20014, 22578, 2064, 2022, 14286, 24436, 2021, 2027, 2097, 2036, 2224, 2591, 8146, 2065, 1996, 1996, 2342, 18653, 1012, 1012, 1012, 1012, 1064, 1064, 1064, 3167, 15768, 2008, 1045, 2031, 2006, 2026, 15363, 2008, 1045, 1005, 2310, 22817, 2013, 6721, 4518, 4573, 1998, 4518, 6302, 24204, 8454, 1012, 1064, 1064, 1064, 1045, 1005, 2222, 2425, 2017, 2043, 1045, 2330, 7760, 18471, 1012, 1024, 1007, 5580, 2017, 2066, 2009, 10763, 1012, 1064, 1064, 1064, 1024, 1040, 4283, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 2331, 16523, 11514, 1012, 1052, 3070, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 2331, 16523, 11514, 2497, 2860, 1012, 1052, 3070, 2081, 2005, 1037, 2767, 1012, 2195, 2847, 1997, 2147, 1012, 1045, 3833, 2296, 2240, 2011, 1012, 1012, 1012, 1064, 1064, 1064, 1024, 1007, 10763, 1024, 8299, 1024, 1013, 1013, 1045, 2620, 16576, 1012, 6302, 24204, 3388, 1012, 4012, 1013, 4042, 1013, 1062, 2480, 2683, 2575, 1013, 27829, 3695, 2080, 1013, 10763, 23615, 6528, 1012, 1052, 3070, 1045, 1005, 2222, 2031, 2000, 2131, 2000, 2115, 22128, 2101, 2065, 2028, 1997, 2026, 3507, 13220, 2987, 1005, 1056, 1012, 1064, 1064, 1064, 15034, 2123, 1005, 1056, 2562, 2033, 2105, 2146, 2438, 2000, 11616, 2033, 1012, 1045, 2066, 2000, 9121, 2007, 2068, 1012, 2054, 1045, 2031, 11616, 2870, 2007, 1998, 2018, 1037, 2261, 15034, 2814, 1006, 1009, 1037, 2261, 2060, 2814, 1007, 2425, 2033, 1045, 2031, 2003, 1012, 1012, 1012, 1005, 102]

3. list[2]
   - Type: list
   - Length: 2102
   - Value: [101, 1005, 2204, 2028, 1035, 1035, 1035, 1035, 1035, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1042, 4048, 18259, 28027, 2546, 2290, 2860, 1064, 1064, 1064, 1997, 2607, 1010, 2000, 2029, 1045, 2360, 1045, 2113, 1025, 2008, 1005, 1055, 2026, 13301, 1998, 2026, 8364, 1012, 1064, 1064, 1064, 2515, 2108, 7078, 3893, 2008, 2017, 1998, 2115, 2190, 2767, 2071, 2022, 2019, 6429, 3232, 4175, 1029, 2065, 2061, 1010, 2084, 2748, 1012, 2030, 2009, 1005, 1055, 2062, 1045, 2071, 2022, 29179, 1999, 2293, 1999, 2553, 1045, 28348, 2026, 5346, 1006, 2029, 2012, 1012, 1012, 1012, 1064, 1064, 1064, 2053, 1010, 1045, 2134, 1005, 1056, 1025, 4067, 2017, 2005, 1037, 4957, 999, 1064, 1064, 1064, 2061, 1011, 2170, 14841, 1011, 9033, 7077, 1006, 1998, 2009, 2064, 7872, 2013, 2151, 2783, 8476, 1013, 17418, 1007, 2064, 2022, 9252, 1012, 2009, 1005, 1055, 2066, 2043, 2017, 1005, 2128, 5881, 1999, 2115, 2219, 4301, 1010, 1998, 2115, 2568, 2074, 17677, 2015, 1999, 7925, 1012, 5683, 5621, 6659, 1012, 1012, 1012, 1012, 1064, 1064, 1064, 2031, 2017, 4384, 2129, 14099, 10072, 2064, 2022, 1029, 2035, 2017, 2031, 2000, 2079, 2003, 2298, 2091, 2012, 1996, 5568, 1024, 9877, 1997, 2367, 3269, 2427, 2045, 1012, 1998, 2085, 5674, 2008, 5606, 1997, 2086, 2101, 1006, 2043, 1013, 2065, 5800, 1012, 1012, 1012, 1064, 1064, 1064, 1996, 3044, 2015, 1516, 2196, 2018, 2053, 2028, 2412, 1064, 1064, 1064, 1045, 2411, 2424, 2870, 27963, 5344, 2006, 7720, 13262, 1013, 3536, 1012, 1064, 1064, 1064, 2023, 1019, 2095, 1011, 2214, 6251, 2003, 2019, 11757, 8321, 1998, 3376, 6412, 1012, 1064, 1064, 1064, 1045, 4033, 1005, 1056, 4716, 2023, 4037, 1999, 1996, 2197, 1017, 2086, 1012, 2061, 9444, 9631, 2023, 1006, 1998, 2672, 2130, 17749, 2033, 1010, 2029, 1045, 3811, 4797, 1007, 1024, 7632, 1012, 6352, 2692, 26224, 6352, 2692, 28311, 1064, 1064, 1064, 2043, 2017, 4133, 1999, 2115, 3871, 2127, 2184, 1024, 2382, 7610, 3015, 2774, 1010, 1998, 6170, 2068, 1006, 2362, 2007, 9877, 1997, 4533, 2015, 1007, 2096, 2652, 2115, 6490, 2858, 1012, 1064, 1064, 1064, 2023, 2003, 1996, 2087, 20014, 2361, 1011, 2003, 2232, 11689, 1045, 1005, 2310, 2412, 2464, 1012, 1064, 1064, 1064, 1045, 2876, 1005, 1056, 2022, 2583, 2000, 2298, 2012, 1996, 4169, 2005, 1996, 2972, 2166, 2065, 1045, 2354, 2008, 1045, 3856, 2009, 2058, 1996, 2529, 2108, 1012, 1064, 1064, 1064, 1045, 2001, 5059, 1037, 4281, 2005, 2026, 7284, 2006, 2029, 1045, 1005, 1049, 2551, 2157, 2085, 1011, 2009, 2323, 2031, 2042, 7733, 1012, 1012, 2021, 1045, 2371, 27885, 14715, 3064, 2000, 2191, 2928, 28194, 5420, 2595, 2683, 2475, 2015, 2695, 11522, 2013, 2009, 1024, 1040, 2065, 2017, 3191, 1996, 2338, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 2318, 2000, 2191, 5888, 2055, 13170, 5146, 1998, 21830, 9610, 7834, 1011, 2182, 2017, 2064, 2156, 2048, 2034, 3441, 1024, 16770, 1024, 1013, 1013, 7479, 1012, 10722, 14905, 20974, 1012, 4012, 1013, 9927, 1013, 1011, 4074, 20348, 29159, 1011, 1064, 1064, 1064, 20014, 3501, 3728, 1045, 2318, 2000, 2695, 2026, 5888, 2055, 2048, 2814, 1011, 13170, 5146, 1998, 21830, 9610, 7834, 1012, 2077, 2008, 1010, 1045, 2074, 6866, 4933, 2008, 4699, 2033, 1010, 2021, 2013, 2085, 2006, 1045, 1005, 2222, 3046, 2000, 2421, 2069, 2026, 2573, 1012, 1012, 1012, 1064, 1064, 1064, 2763, 2057, 2071, 2147, 2362, 2006, 1037, 2047, 2944, 1011, 1045, 1005, 1049, 2019, 6739, 1999, 18772, 18217, 1997, 7239, 2588, 2536, 6881, 4933, 1012, 2008, 6433, 2138, 1997, 14099, 3168, 1997, 8562, 1011, 2061, 14099, 2008, 2025, 2172, 1012, 1012, 1012, 1064, 1064, 1064, 7592, 9541, 20976, 1010, 2017, 2064, 3543, 2009, 1012, 3071, 6732, 2008, 2009, 1005, 1055, 6015, 2030, 6517, 1010, 2021, 2008, 1005, 1055, 2025, 2995, 1011, 1999, 2755, 2009, 2038, 2019, 7078, 8699, 2227, 1012, 1998, 2023, 18401, 2941, 2428, 7777, 26085, 1998, 24459, 1006, 2069, 1012, 1012, 1012, 1064, 1064, 1064, 2092, 1012, 1012, 2785, 1997, 1025, 2004, 2009, 2001, 2525, 3855, 1010, 2823, 2138, 1997, 9152, 2009, 1005, 1055, 2524, 2000, 16636, 3375, 4933, 2029, 16949, 2039, 1999, 2115, 2132, 1999, 1059, 14341, 19570, 2389, 22754, 1997, 10466, 1998, 4620, 2069, 2007, 2616, 1012, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 2228, 2023, 18401, 2052, 2022, 2200, 6413, 2182, 1012, 4261, 26187, 2575, 2475, 1064, 1064, 1064, 4029, 19841, 22022, 1064, 1064, 1064, 2204, 2305, 3071, 2041, 2045, 999, 2130, 2065, 2005, 2619, 2045, 2003, 2851, 2157, 2085, 1011, 6385, 2467, 3565, 6924, 2063, 16956, 1012, 1012, 1998, 2111, 2360, 2204, 2305, 1999, 2344, 2000, 3113, 2279, 2154, 1024, 1007, 1064, 1064, 1064, 2821, 1010, 2008, 3185, 1024, 1007, 2009, 1005, 1055, 12476, 4067, 2017, 999, 3246, 2017, 2018, 2204, 3637, 1999, 1996, 2250, 1025, 4312, 1010, 1045, 1005, 1049, 10261, 2017, 2204, 2305, 2005, 1996, 2279, 2305, 3805, 999, 1006, 11504, 2009, 2097, 2022, 2006, 2455, 1007, 2204, 2111, 10107, 2204, 1012, 1012, 1012, 1064, 1064, 1064, 3486, 2620, 2620, 2620, 2475, 3486, 2620, 2620, 21057, 1064, 1064, 1064, 2092, 1010, 2060, 2111, 2040, 2089, 2022, 6603, 2055, 2019, 3277, 2013, 1996, 2171, 1997, 1996, 8476, 2097, 2424, 2115, 3433, 14044, 4312, 1024, 1007, 1064, 1064, 1064, 2023, 1012, 2633, 2619, 3855, 2008, 1024, 1007, 1064, 1064, 1064, 1045, 2145, 2156, 7329, 1013, 5344, 1999, 1037, 15079, 1997, 2536, 6721, 7060, 1012, 2009, 2064, 2022, 19142, 2823, 1012, 2009, 1005, 1055, 1037, 2200, 18801, 8066, 2043, 2017, 1005, 2128, 11471, 1012, 1064, 1064, 1064, 2821, 1010, 1045, 2134, 1005, 1056, 2113, 2008, 1012, 1012, 2054, 1037, 12063, 1012, 2339, 2025, 8688, 2878, 17006, 1010, 2059, 1029, 2057, 2064, 5630, 2029, 24547, 22345, 2097, 2022, 1996, 2190, 1006, 1045, 2228, 1996, 5221, 2028, 2052, 2022, 2307, 1007, 1012, 1064, 1064, 1064, 12316, 27659, 2182, 2017, 2175, 26231, 8889, 2475, 2002, 6732, 2008, 1996, 2543, 2003, 12090, 1012, 2323, 1045, 8688, 2000, 11263, 1029, 1045, 2123, 1005, 1056, 2066, 2000, 5949, 2833, 1012, 1064, 1064, 1064, 1045, 2123, 1005, 1056, 2228, 2008, 1996, 8543, 1997, 2023, 11689, 14977, 2054, 1005, 1055, 2183, 2006, 2182, 2044, 1017, 2086, 1024, 1007, 1064, 1064, 1064, 2002, 2232, 1010, 1045, 3305, 2017, 1024, 1007, 2007, 2122, 2168, 2445, 4155, 1007, 1007, 1007, 1064, 1064, 1064, 2748, 4757, 2015, 1010, 6172, 2051, 1024, 1040, 1064, 1064, 1064, 1045, 2131, 4854, 3243, 6524, 1010, 2021, 2043, 1045, 2079, 1010, 2009, 1005, 1055, 13726, 2005, 4193, 2111, 2000, 2175, 4873, 2842, 1012, 2009, 1005, 1055, 5263, 2005, 2033, 2000, 5342, 2030, 16081, 4963, 1025, 1996, 2069, 2126, 2000, 2131, 9436, 1997, 2023, 3110, 2003, 2000, 6532, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 1005, 2310, 2196, 4669, 2009, 2505, 8275, 2003, 2919, 1010, 2941, 1012, 1064, 1064, 1064, 24459, 2323, 2022, 2445, 2069, 2000, 4217, 3924, 1012, 4217, 1012, 2045, 2024, 3243, 2261, 1997, 2068, 1010, 2295, 1012, 1064, 1064, 1064, 4090, 2683, 2620, 21057, 1064, 1064, 1064, 9805, 2361, 1010, 2017, 1005, 2128, 2725, 2009, 2157, 1024, 1007, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 1011, 4074, 20348, 29159, 1011, 1012, 10722, 14905, 20974, 1012, 4012, 1013, 1064, 1064, 1064, 17273, 2620, 15136, 1064, 1064, 1064, 1997, 2607, 2009, 1005, 1055, 2025, 2200, 6625, 1012, 2021, 1012, 2529, 2679, 5175, 16047, 2308, 1005, 1055, 3754, 2000, 2507, 4182, 2000, 2060, 2529, 9552, 1012, 2009, 2499, 2005, 5190, 1997, 2086, 1012, 2339, 2689, 2009, 1029, 4661, 1010, 2045, 2024, 1012, 1012, 1012, 1064, 1064, 1064, 2008, 6433, 1012, 1998, 2009, 5158, 2138, 2087, 2411, 2111, 2224, 3463, 1997, 5186, 10480, 1998, 9603, 3784, 5852, 2004, 1037, 3978, 1997, 12515, 2028, 1005, 1055, 2828, 1012, 2119, 5107, 1998, 2653, 2840, 1006, 2062, 1012, 1012, 1012, 1064, 1064, 1064, 22376, 22025, 2575, 1064, 1064, 1064, 1045, 2817, 8425, 2640, 2085, 1010, 2029, 1045, 2428, 5959, 1012, 2054, 2003, 5875, 2055, 2023, 2492, 1010, 2003, 2008, 1996, 3754, 2000, 9699, 4784, 1998, 9611, 3471, 2003, 2172, 2062, 2590, 2084, 6664, 1997, 1037, 3563, 1012, 1012, 1012, 1064, 1064, 1064, 4074, 20348, 29159, 2683, 2581, 1011, 14386, 26802, 5339, 1064, 1064, 1064, 23593, 2683, 2683, 2549, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1016, 8950, 2278, 2078, 2620, 2213, 2683, 2213, 2692, 2213, 1064, 1064, 1064, 1045, 2572, 2467, 3201, 2000, 9009, 1006, 2000, 20014, 27605, 13701, 1010, 2000, 2022, 10480, 1007, 2026, 22941, 1005, 1055, 25042, 1012, 1064, 1064, 1064, 2088, 17882, 1029, 5008, 2111, 1999, 1996, 2132, 1029, 2339, 1029, 2821, 1010, 2157, 1010, 20014, 22578, 2467, 2442, 2022, 17253, 2069, 2007, 2122, 2616, 1012, 1045, 2215, 2000, 2265, 2061, 6649, 2026, 4668, 2000, 2023, 1024, 19594, 19317, 2575, 1064, 1064, 1064, 20741, 10790, 2575, 1064, 1064, 1064, 21541, 2361, 1029, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1021, 5603, 4160, 6977, 2595, 2863, 5657, 1005, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</code></pre>
</div>
</div>
<div id="cell-99" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mp.show_list(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    tokenizer(d[<span class="st">'posts'</span>],truncation<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List Overview:
Total items: 3

1. list[0]
   - Type: list
   - Length: 512
   - Value: [101, 1005, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1053, 2015, 2595, 16257, 8545, 2509, 21638, 2860, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 4601, 1012, 2865, 1012, 10722, 14905, 20974, 1012, 4012, 1013, 10722, 14905, 20974, 1035, 1048, 14876, 26230, 2692, 2509, 9737, 27717, 19062, 2487, 3217, 9541, 2487, 1035, 3156, 1012, 16545, 2290, 1064, 1064, 1064, 4372, 22540, 1998, 20014, 3501, 5312, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1045, 2480, 2581, 2571, 2487, 2290, 2549, 2595, 2213, 2549, 2998, 13013, 2121, 2025, 2327, 2702, 3248, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 15384, 20952, 4371, 2487, 12870, 2278, 26418, 2015, 1064, 1064, 1064, 2054, 2038, 2042, 1996, 2087, 2166, 1011, 5278, 3325, 1999, 2115, 2166, 1029, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1058, 2595, 4371, 2100, 2860, 13088, 2094, 2860, 2620, 8299, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1057, 2620, 20518, 3286, 2629, 18927, 2509, 2063, 2006, 9377, 2005, 2087, 1997, 2651, 1012, 1064, 1064, 1064, 2089, 1996, 2566, 2278, 3325, 10047, 16862, 2063, 2017, 1012, 1064, 1064, 1064, 1996, 2197, 2518, 2026, 1999, 2546, 3501, 2767, 6866, 2006, 2010, 9130, 2077, 16873, 5920, 1996, 2279, 2154, 1012, 2717, 1999, 3521, 1066, 8299, 1024, 1013, 1013, 6819, 26247, 1012, 4012, 1013, 22238, 20958, 11387, 2575, 1064, 1064, 1064, 7592, 4372, 2546, 3501, 2581, 1012, 3374, 2000, 2963, 1997, 2115, 12893, 1012, 2009, 1005, 1055, 2069, 3019, 2005, 1037, 3276, 2000, 2025, 2022, 15401, 2035, 1996, 2051, 1999, 2296, 2617, 1997, 4598, 1012, 3046, 2000, 3275, 1996, 2524, 2335, 2004, 2335, 1997, 3930, 1010, 2004, 1012, 1012, 1012, 1064, 1064, 1064, 6391, 22025, 2683, 6391, 23499, 2692, 8299, 1024, 1013, 1013, 2813, 23298, 15194, 3258, 1012, 4012, 1013, 2039, 11066, 1013, 23297, 8889, 1013, 6860, 1011, 2879, 1011, 1998, 1011, 2611, 1011, 2813, 23298, 1012, 16545, 2290, 8299, 1024, 1013, 1013, 7045, 1012, 2079, 19139, 2497, 1012, 4012, 1013, 1059, 2361, 1011, 4180, 1013, 2039, 11066, 2015, 1013, 2230, 1013, 5840, 1013, 2461, 1011, 2188, 1011, 2640, 1012, 16545, 2290, 1012, 1012, 1012, 1064, 1064, 1064, 6160, 1998, 4933, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 2447, 7971, 10127, 1012, 4012, 1013, 1059, 2361, 1011, 4180, 1013, 2039, 11066, 2015, 1013, 2286, 1013, 5511, 1013, 2417, 1011, 2417, 1011, 1996, 1011, 20421, 1011, 3040, 1011, 19652, 16086, 22610, 2549, 1011, 10332, 1011, 27908, 1012, 16545, 2290, 2208, 1012, 2275, 1012, 2674, 1012, 1064, 1064, 1064, 4013, 4143, 2278, 1010, 2092, 19892, 21823, 2078, 1010, 2012, 2560, 4228, 2781, 1997, 3048, 2115, 3456, 1006, 1998, 1045, 2123, 1005, 1056, 2812, 3048, 2068, 2096, 3564, 1999, 2115, 2168, 4624, 3242, 1007, 1010, 17901, 1999, 5549, 8156, 1006, 2672, 3046, 21006, 2015, 2004, 1037, 2740, 3771, 4522, 1012, 1012, 1012, 1064, 1064, 1064, 10468, 2272, 2039, 2007, 2093, 5167, 2017, 1005, 2310, 4340, 2008, 2169, 2828, 1006, 2030, 29221, 4127, 2017, 2215, 102]

2. list[1]
   - Type: list
   - Length: 512
   - Value: [101, 1005, 1045, 1005, 1049, 4531, 1996, 3768, 1997, 2033, 1999, 2122, 8466, 2200, 8598, 2075, 1012, 1064, 1064, 1064, 3348, 2064, 2022, 11771, 2065, 2009, 1005, 1055, 1999, 1996, 2168, 2597, 2411, 1012, 2005, 2742, 2033, 1998, 2026, 6513, 2024, 2747, 1999, 2019, 4044, 2073, 2057, 2031, 2000, 5541, 2135, 2224, 11190, 15239, 1998, 8696, 1012, 2045, 3475, 1005, 1056, 2438, 1012, 1012, 1012, 1064, 1064, 1064, 3228, 2047, 3574, 2000, 1005, 2208, 1005, 3399, 1012, 1064, 1064, 1064, 7592, 1008, 4372, 25856, 5861, 1008, 2008, 1005, 1055, 2035, 2009, 3138, 1012, 2084, 2057, 23705, 1998, 2027, 2079, 2087, 1997, 1996, 20661, 2096, 1045, 13399, 2037, 3739, 1998, 2709, 2037, 2616, 2007, 5744, 2773, 13068, 1998, 2062, 5048, 2100, 20237, 1012, 1064, 1064, 1064, 2023, 1009, 3768, 1997, 5703, 1998, 2192, 3239, 12016, 1012, 1064, 1064, 1064, 2613, 26264, 3231, 1045, 3556, 13029, 1012, 4274, 26264, 5852, 2024, 6057, 1012, 1045, 3556, 8574, 2015, 2030, 3020, 1012, 2085, 1010, 2066, 1996, 2280, 10960, 1997, 2023, 11689, 1045, 2097, 5254, 2008, 1045, 2123, 1005, 1056, 2903, 1999, 1996, 26264, 3231, 1012, 2077, 2017, 7221, 4509, 1012, 1012, 1012, 1064, 1064, 1064, 2017, 2113, 2017, 1005, 2128, 2019, 4372, 25856, 2043, 2017, 25887, 2013, 1037, 2609, 2005, 1037, 2095, 1998, 1037, 2431, 1010, 2709, 1010, 1998, 2424, 2111, 2024, 2145, 15591, 2006, 2115, 8466, 1998, 16663, 2115, 4784, 1013, 4301, 1012, 2017, 2113, 2017, 1005, 2128, 2019, 4372, 25856, 2043, 2017, 1012, 1012, 1012, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 10047, 2290, 15136, 2620, 1012, 4871, 3270, 3600, 1012, 2149, 1013, 10047, 2290, 15136, 2620, 1013, 4185, 19317, 1013, 3438, 11387, 2094, 2487, 2546, 2683, 2850, 2575, 2683, 22932, 2050, 2575, 2497, 2581, 2487, 19473, 2575, 1012, 16545, 2290, 1064, 1064, 1064, 8299, 1024, 1013, 1013, 10047, 2290, 1012, 4639, 2094, 16872, 28014, 1012, 4012, 1013, 6282, 2509, 2050, 2692, 2278, 2575, 18827, 22025, 16932, 3540, 2497, 2620, 2549, 2278, 22203, 1064, 1064, 1064, 1045, 2058, 2228, 2477, 2823, 1012, 1045, 2175, 2011, 1996, 2214, 20052, 9106, 14686, 1012, 3383, 1010, 2043, 1037, 2158, 2038, 2569, 3716, 1998, 2569, 4204, 2066, 2026, 2219, 1010, 2009, 2738, 16171, 2032, 2000, 6148, 1037, 3375, 1012, 1012, 1012, 1064, 1064, 1064, 13789, 12155, 10270, 1012, 10722, 14905, 20974, 1012, 4012, 2061, 2003, 1045, 1024, 1040, 1064, 1064, 1064, 4278, 1010, 2199, 1009, 2695, 1064, 1064, 1064, 2025, 2428, 1025, 1045, 1005, 2310, 2196, 2245, 1997, 1041, 1013, 1045, 2030, 1046, 1013, 1052, 2004, 2613, 4972, 1012, 1045, 3648, 2870, 2006, 2054, 1045, 2224, 1012, 1045, 2224, 11265, 1998, 14841, 2004, 2026, 29532, 1012, 10768, 2005, 6699, 1998, 6524, 9033, 1012, 1045, 2036, 2224, 9152, 2349, 2000, 2033, 3997, 1012, 1012, 1012, 1064, 1064, 1064, 2017, 2113, 2295, 1012, 2008, 2001, 13749, 18595, 3560, 1012, 2044, 3038, 2009, 1045, 2428, 2215, 2000, 3046, 2009, 1998, 2156, 2054, 6433, 2007, 2033, 2652, 1037, 2034, 2711, 13108, 1999, 1996, 2067, 2096, 2057, 3298, 2105, 1012, 1045, 2215, 2000, 2156, 1996, 2298, 2006, 1012, 1012, 1012, 1064, 1064, 1064, 2041, 1997, 2035, 1997, 2068, 1996, 2600, 3259, 2028, 102]

3. list[2]
   - Type: list
   - Length: 512
   - Value: [101, 1005, 2204, 2028, 1035, 1035, 1035, 1035, 1035, 16770, 1024, 1013, 1013, 7479, 1012, 7858, 1012, 4012, 1013, 3422, 1029, 1058, 1027, 1042, 4048, 18259, 28027, 2546, 2290, 2860, 1064, 1064, 1064, 1997, 2607, 1010, 2000, 2029, 1045, 2360, 1045, 2113, 1025, 2008, 1005, 1055, 2026, 13301, 1998, 2026, 8364, 1012, 1064, 1064, 1064, 2515, 2108, 7078, 3893, 2008, 2017, 1998, 2115, 2190, 2767, 2071, 2022, 2019, 6429, 3232, 4175, 1029, 2065, 2061, 1010, 2084, 2748, 1012, 2030, 2009, 1005, 1055, 2062, 1045, 2071, 2022, 29179, 1999, 2293, 1999, 2553, 1045, 28348, 2026, 5346, 1006, 2029, 2012, 1012, 1012, 1012, 1064, 1064, 1064, 2053, 1010, 1045, 2134, 1005, 1056, 1025, 4067, 2017, 2005, 1037, 4957, 999, 1064, 1064, 1064, 2061, 1011, 2170, 14841, 1011, 9033, 7077, 1006, 1998, 2009, 2064, 7872, 2013, 2151, 2783, 8476, 1013, 17418, 1007, 2064, 2022, 9252, 1012, 2009, 1005, 1055, 2066, 2043, 2017, 1005, 2128, 5881, 1999, 2115, 2219, 4301, 1010, 1998, 2115, 2568, 2074, 17677, 2015, 1999, 7925, 1012, 5683, 5621, 6659, 1012, 1012, 1012, 1012, 1064, 1064, 1064, 2031, 2017, 4384, 2129, 14099, 10072, 2064, 2022, 1029, 2035, 2017, 2031, 2000, 2079, 2003, 2298, 2091, 2012, 1996, 5568, 1024, 9877, 1997, 2367, 3269, 2427, 2045, 1012, 1998, 2085, 5674, 2008, 5606, 1997, 2086, 2101, 1006, 2043, 1013, 2065, 5800, 1012, 1012, 1012, 1064, 1064, 1064, 1996, 3044, 2015, 1516, 2196, 2018, 2053, 2028, 2412, 1064, 1064, 1064, 1045, 2411, 2424, 2870, 27963, 5344, 2006, 7720, 13262, 1013, 3536, 1012, 1064, 1064, 1064, 2023, 1019, 2095, 1011, 2214, 6251, 2003, 2019, 11757, 8321, 1998, 3376, 6412, 1012, 1064, 1064, 1064, 1045, 4033, 1005, 1056, 4716, 2023, 4037, 1999, 1996, 2197, 1017, 2086, 1012, 2061, 9444, 9631, 2023, 1006, 1998, 2672, 2130, 17749, 2033, 1010, 2029, 1045, 3811, 4797, 1007, 1024, 7632, 1012, 6352, 2692, 26224, 6352, 2692, 28311, 1064, 1064, 1064, 2043, 2017, 4133, 1999, 2115, 3871, 2127, 2184, 1024, 2382, 7610, 3015, 2774, 1010, 1998, 6170, 2068, 1006, 2362, 2007, 9877, 1997, 4533, 2015, 1007, 2096, 2652, 2115, 6490, 2858, 1012, 1064, 1064, 1064, 2023, 2003, 1996, 2087, 20014, 2361, 1011, 2003, 2232, 11689, 1045, 1005, 2310, 2412, 2464, 1012, 1064, 1064, 1064, 1045, 2876, 1005, 1056, 2022, 2583, 2000, 2298, 2012, 1996, 4169, 2005, 1996, 2972, 2166, 2065, 1045, 2354, 2008, 1045, 3856, 2009, 2058, 1996, 2529, 2108, 1012, 1064, 1064, 1064, 1045, 2001, 5059, 1037, 4281, 2005, 2026, 7284, 2006, 2029, 1045, 1005, 1049, 2551, 2157, 2085, 1011, 2009, 2323, 2031, 2042, 7733, 1012, 1012, 2021, 1045, 2371, 27885, 14715, 3064, 2000, 2191, 2928, 28194, 5420, 2595, 2683, 2475, 2015, 2695, 11522, 2013, 2009, 1024, 1040, 2065, 2017, 3191, 1996, 2338, 1012, 1012, 1012, 1064, 1064, 1064, 1045, 2318, 2000, 2191, 5888, 2055, 13170, 5146, 1998, 21830, 9610, 7834, 1011, 2182, 2017, 2064, 2156, 2048, 2034, 3441, 1024, 16770, 1024, 1013, 1013, 7479, 1012, 10722, 14905, 20974, 1012, 4012, 1013, 9927, 1013, 1011, 4074, 20348, 29159, 1011, 1064, 1064, 1064, 20014, 3501, 3728, 1045, 2318, 2000, 2695, 2026, 5888, 2055, 2048, 2814, 1011, 13170, 5146, 1998, 21830, 9610, 7834, 1012, 2077, 102]</code></pre>
</div>
</div>
<p><em>성공</em></p>
<div id="cell-101" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>model1(torch.tensor(tokenizer(d[<span class="st">'posts'</span>],truncation<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#model1(tokenizer(d['posts'],truncation=True,return_tensors="pt")['input_ids'])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0450,  0.1728],
        [-0.0259,  0.1809],
        [-0.0611,  0.1994]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(풀이2)</code> <em>–모델설정변경 (퀴즈5, 모델의 프레임수를 4로 바꾸는 예제에서 사용한 테크닉)</em></p>
<p><em>distilbert/distilbert-base-uncased 설정값 부르기</em></p>
<div id="cell-104" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> transformers.AutoConfig.from_pretrained(</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>DistilBertConfig {
  "_name_or_path": "distilbert/distilbert-base-uncased",
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "transformers_version": "4.46.2",
  "vocab_size": 30522
}</code></pre>
</div>
</div>
<p><em>설정값변경</em></p>
<div id="cell-106" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>config.max_position_embeddings <span class="op">=</span> <span class="dv">2200</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>설정값으로 모델불러오기</em></p>
<div id="cell-108" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>model1_large <span class="op">=</span> transformers.AutoModelForSequenceClassification.from_config(</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    config<span class="op">=</span>config</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>모델사용</em></p>
<div id="cell-110" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>model1_large(torch.tensor(tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>)[<span class="st">'input_ids'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[ 0.1023,  0.1124],
        [ 0.1443, -0.0719],
        [ 0.2653, -0.0368]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<div id="cell-111" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model1_large(<span class="op">**</span>tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>,return_tensors<span class="op">=</span><span class="st">"pt"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[0.1730, 0.0042],
        [0.2185, 0.0896],
        [0.3406, 0.0155]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
<p><code># 예제4</code> – sms_spam</p>
<div id="cell-114" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sms_spam <span class="op">=</span> datasets.load_dataset(<span class="st">'sms_spam'</span>)[<span class="st">'train'</span>].train_test_split(test_size<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>sms_spam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>DatasetDict({
    train: Dataset({
        features: ['sms', 'label'],
        num_rows: 4459
    })
    test: Dataset({
        features: ['sms', 'label'],
        num_rows: 1115
    })
})</code></pre>
</div>
</div>
<div id="cell-115" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> sms_spam[<span class="st">'train'</span>].select(<span class="bu">range</span>(<span class="dv">3</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>Dataset({
    features: ['sms', 'label'],
    num_rows: 3
})</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-117" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>model1(<span class="op">**</span>tokenizer(d[<span class="st">'sms'</span>],padding<span class="op">=</span><span class="va">True</span>,return_tensors<span class="op">=</span><span class="st">"pt"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0118,  0.1699],
        [ 0.0273,  0.1815],
        [-0.0208,  0.2202]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
</section>
<section id="b.-이미지" class="level2">
<h2 class="anchored" data-anchor-id="b.-이미지">B. 이미지</h2>
<div id="cell-120" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    num_labels<span class="op">=</span><span class="dv">3</span> <span class="co"># 그냥 대충 3이라고 했음.. 별 이유는 없음</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code># 예제1</code> – food101</p>
<div id="cell-122" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> datasets.load_dataset(<span class="st">"food101"</span>, split<span class="op">=</span><span class="st">"train[:4]"</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Dataset({
    features: ['image', 'label'],
    num_rows: 4
})</code></pre>
</div>
</div>
<p><code>(예비학습)</code> – <code>torchvision.transforms</code> 에서 제공하는 기능들은 배치처리가 가능한가?</p>
<div id="cell-124" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>to_tensor <span class="op">=</span> torchvision.transforms.ToTensor()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-125" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>to_tensor(d[<span class="st">'image'</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>tensor([[[0.1216, 0.1137, 0.1098,  ..., 0.0039, 0.0039, 0.0000],
         [0.1255, 0.1216, 0.1176,  ..., 0.0039, 0.0039, 0.0000],
         [0.1294, 0.1255, 0.1255,  ..., 0.0039, 0.0000, 0.0000],
         ...,
         [0.2588, 0.2745, 0.2863,  ..., 0.3765, 0.3882, 0.3922],
         [0.2353, 0.2471, 0.2667,  ..., 0.3373, 0.3373, 0.3373],
         [0.2235, 0.2275, 0.2471,  ..., 0.3333, 0.3176, 0.3059]],

        [[0.1373, 0.1294, 0.1255,  ..., 0.1020, 0.1020, 0.0980],
         [0.1412, 0.1373, 0.1333,  ..., 0.1020, 0.1020, 0.0980],
         [0.1451, 0.1412, 0.1412,  ..., 0.1020, 0.0980, 0.0980],
         ...,
         [0.2471, 0.2627, 0.2745,  ..., 0.3647, 0.3765, 0.3882],
         [0.2235, 0.2353, 0.2549,  ..., 0.3255, 0.3333, 0.3333],
         [0.2118, 0.2157, 0.2353,  ..., 0.3216, 0.3137, 0.3020]],

        [[0.1412, 0.1333, 0.1294,  ..., 0.0902, 0.0902, 0.0863],
         [0.1451, 0.1412, 0.1451,  ..., 0.0902, 0.0902, 0.0863],
         [0.1490, 0.1451, 0.1529,  ..., 0.0902, 0.0863, 0.0863],
         ...,
         [0.1725, 0.1882, 0.2000,  ..., 0.2431, 0.2549, 0.2667],
         [0.1490, 0.1608, 0.1804,  ..., 0.2039, 0.2118, 0.2118],
         [0.1373, 0.1412, 0.1608,  ..., 0.2000, 0.1922, 0.1804]]])</code></pre>
</div>
</div>
<div id="cell-126" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>to_tensor(d[<span class="st">'image'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: pic should be PIL Image or ndarray. Got &lt;class 'list'&gt;</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-128" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>compose <span class="op">=</span> torchvision.transforms.Compose([</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.ToTensor(),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.Resize((<span class="dv">224</span>,<span class="dv">224</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-129" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>torch.stack(<span class="bu">list</span>(<span class="bu">map</span>(compose,d[<span class="st">'image'</span>])),axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>torch.Size([4, 3, 224, 224])</code></pre>
</div>
</div>
<div id="cell-130" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>model2.forward(</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    torch.stack(<span class="bu">list</span>(<span class="bu">map</span>(compose,d[<span class="st">'image'</span>])),axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[ 0.0472,  0.0317, -0.1932],
        [ 0.2093,  0.1209, -0.0129],
        [ 0.0555,  0.0957, -0.0811],
        [-0.0682,  0.0363,  0.0317]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
<p><code># 예제2</code></p>
<div id="cell-133" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>beans <span class="op">=</span> datasets.load_dataset(<span class="st">'beans'</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> beans[<span class="st">'train'</span>].select(<span class="bu">range</span>(<span class="dv">4</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>Dataset({
    features: ['image_file_path', 'image', 'labels'],
    num_rows: 4
})</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-135" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>model2(torch.stack(<span class="bu">list</span>(<span class="bu">map</span>(compose,d[<span class="st">'image'</span>])),axis<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[ 0.0545, -0.0993, -0.0386],
        [ 0.0576, -0.1576, -0.0019],
        [ 0.0982, -0.1531, -0.1147],
        [ 0.0570, -0.0575, -0.1455]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>#</code></p>
</section>
<section id="c.-동영상" class="level2">
<h2 class="anchored" data-anchor-id="c.-동영상">C. 동영상</h2>
<div id="cell-138" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> transformers.VideoMAEForVideoClassification.from_pretrained(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MCG-NJU/videomae-base"</span>,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of VideoMAEForVideoClassification were not initialized from the model checkpoint at MCG-NJU/videomae-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code># 예제1</code> – UCF101_subset</p>
<div id="cell-140" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> huggingface_hub.hf_hub_download(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    repo_id<span class="op">=</span><span class="st">"sayakpaul/ucf101-subset"</span>,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">=</span><span class="st">"UCF101_subset.tar.gz"</span>,</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    repo_type<span class="op">=</span><span class="st">"dataset"</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># file_path는 다운로드한 압축파일이 존재하는 경로와 파일명이 string으로 저장되어있음.</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> tarfile.<span class="bu">open</span>(file_path) <span class="im">as</span> t:</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>     t.extractall(<span class="st">"./data"</span>) <span class="co"># 여기에서 "."은 현재폴더라는 의미</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-141" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>mp.tree(<span class="st">"./data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>└── UCF101_subset
    ├── test
    │   ├── ApplyEyeMakeup
    │   │   ├── UCF101
    │   │   ├── v_ApplyEyeMakeup_g03_c01.avi
    │   │   └── ...
    │   │   └── v_ApplyEyeMakeup_g23_c06.avi
    │   ├── ApplyLipstick
    │   │   ├── UCF101
    │   │   ├── v_ApplyLipstick_g14_c01.avi
    │   │   └── ...
    │   │   └── v_ApplyLipstick_g16_c04.avi
    │   └── ...
    │   └── BenchPress
    │       ├── UCF101
    │       ├── v_BenchPress_g05_c02.avi
    │       └── ...
    │       └── v_BenchPress_g25_c06.avi
    ├── train
    │   ├── ApplyEyeMakeup
    │   │   ├── UCF101
    │   │   ├── v_ApplyEyeMakeup_g02_c03.avi
    │   │   └── ...
    │   │   └── v_ApplyEyeMakeup_g25_c07.avi
    │   ├── ApplyLipstick
    │   │   ├── UCF101
    │   │   ├── v_ApplyLipstick_g01_c02.avi
    │   │   └── ...
    │   │   └── v_ApplyLipstick_g24_c05.avi
    │   └── ...
    │   └── BenchPress
    │       ├── UCF101
    │       ├── v_BenchPress_g01_c05.avi
    │       └── ...
    │       └── v_BenchPress_g24_c05.avi
    └── val
        ├── ApplyEyeMakeup
        │   ├── UCF101
        │   ├── v_ApplyEyeMakeup_g01_c01.avi
        │   ├── v_ApplyEyeMakeup_g14_c05.avi
        │   └── v_ApplyEyeMakeup_g20_c04.avi
        ├── ApplyLipstick
        │   ├── UCF101
        │   ├── v_ApplyLipstick_g10_c04.avi
        │   ├── v_ApplyLipstick_g20_c04.avi
        │   └── v_ApplyLipstick_g25_c02.avi
        └── ...
        └── BenchPress
            ├── UCF101
            ├── v_BenchPress_g11_c05.avi
            ├── v_BenchPress_g17_c02.avi
            └── v_BenchPress_g17_c06.avi</code></pre>
</div>
</div>
<div id="cell-142" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>video_path <span class="op">=</span> <span class="st">"./data/UCF101_subset/test/BenchPress/v_BenchPress_g05_c02.avi"</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>video <span class="op">=</span> pytorchvideo.data.encoded_video.EncodedVideo.from_path(video_path).get_clip(<span class="dv">0</span>, <span class="bu">float</span>(<span class="st">'inf'</span>))[<span class="st">'video'</span>]</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>video.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>torch.Size([3, 67, 240, 320])</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-144" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>model3(</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#video.permute(1,0,2,3)[:16,:,:224,:224].unsqueeze(0)</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#video.permute(1,0,2,3)[:16,:,:224,:224].reshape(1,16,3,224,224)</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    torch.stack([video.permute(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>)[:<span class="dv">16</span>,:,:<span class="dv">224</span>,:<span class="dv">224</span>]])</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.1375,  0.4270]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="guebin/MP2023" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="최규빈">
<meta name="dcterms.date" content="2024-11-19">

<title>MP2024 - Quiz-7 (2024.11.19) // 범위: 09wk-2 까지</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MP2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../quiz.html"> 
<span class="menu-text"><strong>Quiz &amp; Report</strong></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/MP2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=2"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Quiz-7 (2024.11.19)</strong> // 범위: 09wk-2 까지</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>최규빈 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/guebin/MP2024/blob/main/quiz/Quiz-7.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" style="text-align: left"></a></p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 22%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th><strong>항목</strong></th>
<th><strong>허용 여부</strong></th>
<th><strong>비고</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>강의노트 참고</strong></td>
<td>허용</td>
<td>수업 중 제공된 강의노트나 본인이 정리한 자료를 참고 가능</td>
</tr>
<tr class="even">
<td><strong>구글 검색</strong></td>
<td>허용</td>
<td>인터넷을 통한 자료 검색 및 정보 확인 가능</td>
</tr>
<tr class="odd">
<td><strong>생성 모형 사용</strong></td>
<td>허용 안함</td>
<td>인공지능 기반 도구(GPT 등) 사용 불가</td>
</tr>
</tbody>
</table>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/playlist?list=PLQqh36zP38-yEeRCBlJDtUDDr5CESCXlE&amp;si=dVV7eLd7fY6fFSsJ" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<div id="cell-4" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install datasets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> transformers</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datasets</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---#</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/cgb3/anaconda3/envs/hf/lib/python3.12/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm</code></pre>
</div>
</div>
<section id="model" class="level1">
<h1>1. <code>model</code></h1>
<p><code>(1)</code> 아래의 자료를 관찰하라.</p>
<div id="cell-8" class="cell" data-outputid="9f31cd7b-bf4e-4415-f180-ee52feac554c" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> datasets.load_dataset(<span class="st">"food101"</span>, split<span class="op">=</span><span class="st">"train[:8]"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>_transforms <span class="op">=</span> torchvision.transforms.Compose([</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.Resize((<span class="dv">224</span>,<span class="dv">224</span>)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.ToTensor(),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transforms(examples):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    examples[<span class="st">"pixel_values"</span>] <span class="op">=</span> [_transforms(img) <span class="cf">for</span> img <span class="kw">in</span> examples[<span class="st">"image"</span>]]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> examples[<span class="st">"image"</span>]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> examples</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> d.with_transform(transforms)[:<span class="dv">8</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>d</code>를 아래 <code>model</code>의 입력으로 사용하여 loss를 계산하라.</p>
<div id="cell-10" class="cell" data-outputid="48e3d607-2652-4a84-d62e-b3a572810fa7" data-execution_count="20">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    num_labels<span class="op">=</span><span class="dv">101</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0d1587e426d240abb5de16c1b987ca00","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d836f9819ac84a7f81fe406536a92bbb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-12" class="cell" data-outputid="84f59ccb-648f-4c46-e7fc-40ad85de36e2" data-execution_count="21">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model.forward(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>torch.tensor(d[<span class="st">'label'</span>]),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    pixel_values<span class="op">=</span>torch.stack(d[<span class="st">'pixel_values'</span>], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>ImageClassifierOutput(loss=tensor(4.5997, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[ 7.6826e-02, -9.0105e-02,  7.5432e-02, -2.1185e-02,  1.5584e-01,
          7.3810e-02, -4.8122e-02, -5.3405e-02, -3.3512e-01, -2.2982e-01,
          6.2435e-02, -9.6915e-03,  8.9590e-03, -1.5497e-02,  1.8300e-01,
         -6.7354e-02,  1.9398e-01,  3.1862e-02, -3.0895e-02,  9.6069e-02,
         -1.6055e-01,  2.2154e-02, -8.2704e-02, -1.6198e-01,  1.0405e-01,
          3.8576e-02,  4.0748e-02,  9.8216e-02, -1.6747e-02, -2.5526e-02,
          8.3804e-02, -1.0589e-01,  2.5652e-02, -3.4092e-02, -9.8487e-02,
         -2.7755e-02,  1.0211e-02,  6.6089e-02,  7.3731e-02, -1.0649e-01,
          2.5525e-02,  4.8274e-02, -1.2212e-02,  1.1350e-01, -5.9155e-02,
          7.2843e-02, -5.7654e-02,  2.6358e-02, -1.4207e-02,  1.3983e-01,
          6.7270e-02, -8.4355e-02, -8.4920e-02,  8.4042e-02,  6.3501e-02,
         -1.2900e-01, -5.7161e-02,  1.6566e-01, -1.2487e-01, -9.7119e-02,
         -1.5221e-01,  2.1401e-01,  9.4425e-02,  8.4416e-02, -1.6235e-02,
         -1.4726e-01,  1.1324e-01, -1.0840e-01, -7.6411e-03, -2.2510e-01,
          1.2032e-02,  2.1051e-01,  1.3724e-01, -2.0181e-02,  1.5389e-02,
         -2.4832e-02, -2.1742e-01, -3.4528e-02,  1.0598e-01,  1.3383e-01,
         -1.2902e-01,  1.3344e-02, -3.6203e-02, -1.2312e-01, -4.9924e-02,
          5.3998e-02, -7.9252e-02, -2.0521e-02, -1.0370e-02, -6.2382e-02,
         -5.3397e-02, -2.1545e-02,  2.4555e-01, -1.0837e-01, -5.2716e-02,
         -3.8042e-02,  1.1873e-01,  9.2327e-02,  1.5943e-02, -2.2889e-02,
         -4.7897e-02],
        [ 1.1188e-01,  6.8977e-03,  2.7531e-02, -1.1447e-01, -9.8963e-03,
          1.5592e-01,  2.2469e-02, -1.6465e-01, -9.2218e-02, -1.3464e-01,
          1.3903e-01,  8.5439e-02,  2.2874e-02, -6.2274e-02, -8.6971e-02,
         -7.5859e-02,  8.3531e-02,  8.1950e-02,  6.0326e-02, -1.7273e-01,
         -8.3339e-02,  1.5062e-01, -7.7413e-02, -2.9653e-02,  2.0201e-02,
          3.4206e-02,  1.6945e-02,  1.1270e-01,  1.4237e-01,  8.7586e-02,
          1.6947e-01, -7.1226e-03, -1.9013e-02, -3.9833e-02,  5.0335e-02,
         -8.3362e-02,  6.1431e-03,  1.6856e-01, -1.6370e-01, -1.8751e-01,
         -3.4121e-02,  1.7139e-01,  1.2031e-02, -2.9437e-02, -1.7220e-01,
          8.1221e-02,  2.6955e-03,  5.2098e-02,  1.4157e-01,  6.0883e-02,
         -5.4722e-02, -1.3417e-01, -1.8741e-01, -1.8906e-02,  2.7238e-02,
         -1.4890e-01,  1.3666e-01,  2.9241e-02,  1.1901e-01, -1.8813e-01,
         -1.2579e-01,  1.1834e-01,  1.0300e-02,  3.9116e-02, -8.6755e-02,
         -1.0378e-01, -3.1473e-02,  7.7547e-02, -5.1821e-02, -2.0954e-01,
          4.1575e-02,  4.3429e-02, -1.2075e-02,  7.0189e-02, -1.2232e-01,
         -6.5592e-02, -1.1457e-01, -9.2240e-02,  1.5634e-01,  1.0332e-01,
         -1.3351e-01, -2.5504e-02, -1.6221e-01, -4.0601e-02,  2.3233e-02,
         -1.5017e-01, -4.9325e-02,  4.5483e-02,  1.0775e-04, -3.5611e-03,
          6.2557e-03,  1.5400e-01,  1.8519e-01, -1.2308e-01, -1.0690e-01,
         -2.6284e-02,  6.4903e-02,  5.8166e-02, -7.4635e-02,  1.0414e-01,
         -7.1878e-02],
        [ 8.3454e-02, -1.7464e-02,  9.6078e-02, -7.8314e-02,  5.3206e-02,
          1.3365e-01,  1.4758e-02, -5.0545e-02, -2.3400e-01, -9.3800e-02,
          5.1795e-04,  5.2090e-02,  4.0230e-02,  3.5658e-02, -7.4095e-02,
         -9.0949e-02,  1.6369e-01,  1.0158e-01,  3.1612e-02,  1.8942e-02,
         -9.9837e-03, -2.9345e-02, -6.0241e-02, -1.7624e-02,  7.8234e-02,
         -1.0971e-01,  8.2808e-02,  1.4628e-02,  4.6643e-02, -1.0322e-02,
          4.0841e-02,  4.5129e-03, -6.3666e-02, -1.2433e-01, -8.7436e-02,
         -6.6283e-02,  7.1268e-02,  7.5205e-02, -6.2879e-02, -4.9454e-02,
          2.5345e-02,  1.9322e-01, -7.1178e-02, -9.2667e-03, -3.2151e-02,
          1.1101e-01,  5.4731e-02,  6.8563e-02,  1.7650e-01,  1.5907e-01,
          3.1264e-02, -1.0033e-01, -1.2024e-01,  2.9210e-02,  1.5264e-01,
         -8.1677e-02,  4.2990e-02,  4.6707e-02, -7.2563e-02, -5.5904e-02,
         -8.1827e-02,  7.2650e-02,  5.3886e-02,  1.1260e-01, -1.2676e-02,
         -1.0600e-01,  4.4539e-02, -2.5486e-02, -8.3940e-02, -1.7769e-01,
          4.0808e-02,  7.3820e-02,  6.4229e-02,  4.0850e-03, -5.5198e-02,
          6.5355e-03, -1.1622e-01, -1.1486e-01,  6.2790e-02,  1.2788e-01,
         -1.3774e-01, -3.7448e-02,  3.6094e-02, -4.3242e-02,  2.2369e-02,
          4.5747e-02, -4.3836e-02, -5.7471e-02, -2.5824e-02,  3.5743e-02,
         -3.3916e-02,  5.3398e-03,  1.0495e-01, -5.7004e-02,  9.9216e-02,
          2.0817e-02,  1.2368e-01, -8.3626e-02, -4.2389e-02,  4.7912e-02,
         -5.0829e-02],
        [-9.4346e-02, -1.0898e-01, -1.0180e-02, -1.7139e-01, -1.1359e-01,
         -1.1509e-01,  1.3198e-01,  1.0231e-01,  5.4028e-02,  1.4325e-01,
          1.0368e-01,  6.5669e-02,  3.4917e-02, -1.8831e-01, -1.5879e-01,
         -3.2228e-03, -1.2673e-01,  3.0889e-02,  8.4178e-02, -1.2064e-01,
         -7.7863e-03,  4.4275e-02, -8.5879e-02, -1.0124e-01, -3.8455e-02,
         -7.0958e-02,  1.2863e-01,  6.8275e-02, -1.2072e-02, -5.9935e-03,
         -4.5137e-03, -2.9461e-02, -1.3239e-01, -6.4135e-02, -6.8259e-02,
         -7.9751e-02, -7.1084e-02,  7.7529e-02,  3.4804e-02, -1.3198e-01,
         -1.0916e-01, -1.5193e-01, -1.1269e-01, -2.3167e-01,  2.1231e-02,
          1.1357e-01,  7.9064e-02, -1.4860e-02,  8.4246e-02, -2.6162e-02,
          7.9698e-02, -3.3303e-02,  8.6202e-02, -1.4442e-01,  6.1333e-03,
         -5.3624e-02, -1.1164e-01, -8.3984e-03,  6.3743e-02,  3.9429e-02,
         -6.4561e-03, -1.0856e-01,  5.8817e-04, -4.9399e-02,  4.0378e-02,
          1.1429e-01, -3.6314e-02,  8.1419e-02,  2.1837e-01, -7.3273e-02,
          1.2880e-02, -2.8462e-02,  2.1577e-01,  1.8301e-01, -5.1624e-02,
          5.1300e-02, -1.2909e-01,  1.9539e-01,  2.4810e-01,  1.1181e-01,
          3.5251e-02,  2.6556e-01,  1.0448e-01,  2.5936e-02,  4.3115e-02,
          8.5593e-02,  8.1973e-03, -1.1744e-01, -1.5502e-01, -2.0239e-01,
          2.8152e-01,  4.4686e-02,  1.6554e-01, -2.4731e-01,  2.0113e-02,
         -1.5778e-01,  3.9013e-02, -4.4591e-02, -1.5734e-01,  7.0030e-02,
          7.3710e-02],
        [ 9.1484e-02,  1.9428e-03,  6.7192e-02, -5.3958e-02, -1.3578e-02,
          2.3692e-02,  1.1579e-01, -5.1181e-02, -8.6415e-02, -4.6918e-02,
          3.5304e-02, -6.2002e-02, -6.7094e-02, -5.4630e-02, -3.8574e-03,
         -8.6196e-02,  1.2100e-01,  9.8612e-02, -3.4887e-02, -4.0103e-02,
         -1.1676e-01,  1.1268e-01, -4.6907e-02,  8.0041e-02, -9.1498e-03,
         -1.1369e-01, -4.9732e-02, -3.9191e-02,  2.2806e-03, -9.4521e-03,
          1.0769e-01, -2.2485e-02,  8.4227e-02, -1.2566e-01,  7.0916e-02,
         -1.3824e-01,  3.4383e-02,  2.8987e-01, -2.9587e-02, -2.1134e-01,
          5.2647e-02,  1.9974e-01,  5.8155e-02,  3.6288e-02, -4.0187e-02,
          5.4001e-02,  1.6494e-01, -1.4371e-02,  6.0328e-02,  6.6007e-03,
         -1.7996e-02, -2.2812e-01, -1.0069e-02,  1.3870e-01,  9.9448e-02,
         -1.0185e-01,  9.3195e-02, -7.7491e-03,  1.1225e-01, -8.8549e-02,
         -1.7836e-01,  1.6137e-01,  2.1840e-01,  1.1491e-01, -2.6517e-02,
         -9.6914e-02,  1.4414e-02,  5.0654e-02,  4.8849e-03, -2.1760e-01,
          1.2459e-01,  1.5795e-01, -1.1280e-02,  1.3144e-01, -7.6349e-02,
          1.8674e-01, -1.1992e-01,  6.0513e-02,  4.7480e-02,  1.3025e-03,
         -1.0591e-02,  2.3180e-02, -7.0612e-02, -3.0720e-02,  3.2069e-02,
         -8.0909e-02, -6.9726e-02, -7.0269e-02,  2.9035e-02, -4.9897e-02,
         -5.8495e-02,  1.3604e-01,  1.3136e-01, -1.3679e-01, -1.0470e-01,
         -3.0206e-02,  2.1697e-03,  3.9131e-02,  6.4948e-03,  9.5721e-02,
         -1.8183e-02],
        [-6.8091e-02, -2.2053e-02, -5.4299e-02,  1.0026e-02, -7.5670e-02,
          2.9120e-01, -1.2530e-01, -2.7368e-02,  6.3109e-02, -6.3433e-02,
          1.9503e-01,  9.7034e-02,  1.3122e-01, -2.3407e-02,  6.7617e-02,
         -7.8881e-02, -1.2107e-01,  4.3068e-02, -1.0447e-01,  1.0066e-02,
         -1.3075e-01,  1.8664e-01, -1.2884e-01, -2.3350e-01, -5.3403e-02,
         -2.1424e-02,  1.4673e-01,  4.2965e-02, -2.0390e-02,  1.8080e-03,
         -2.1195e-02, -6.6838e-02, -1.8415e-01, -7.2461e-02,  5.1177e-02,
         -8.9933e-02,  1.2272e-01,  1.5792e-01,  1.3150e-01, -1.7502e-01,
          9.1137e-02,  2.2346e-01,  5.6453e-02,  8.6020e-03,  8.5138e-04,
          5.9339e-02, -1.0922e-02,  4.7535e-02, -2.1344e-02, -1.3891e-01,
         -9.8343e-02, -2.1360e-02, -1.0708e-01,  8.2102e-02,  1.8533e-02,
         -1.1787e-01,  1.2372e-02, -1.2645e-01,  8.0801e-02, -1.4910e-01,
         -1.2865e-01, -7.5083e-03,  3.0437e-03, -4.6185e-02, -6.0365e-02,
         -3.6952e-02, -1.3331e-01,  7.7585e-02, -7.9826e-02, -1.5719e-01,
          4.0447e-02,  2.0216e-01, -3.7560e-02, -1.6181e-02,  1.5465e-01,
          2.8233e-02, -1.2869e-01, -7.2256e-04,  8.6663e-02,  1.2580e-01,
         -1.8632e-02,  6.8527e-02, -1.1103e-01, -1.9610e-01, -2.4999e-04,
         -5.0273e-02, -2.6269e-02,  1.8548e-02, -1.0961e-01, -9.7892e-02,
          7.6467e-02,  5.6241e-02,  1.2632e-01, -9.1389e-02,  6.3114e-02,
          1.7551e-02,  1.5902e-02, -3.6639e-02,  6.2470e-02,  8.0667e-02,
         -5.1057e-02],
        [-8.5142e-02, -8.9607e-02, -6.4751e-02, -2.8778e-01,  1.5176e-01,
          1.9441e-01,  3.1547e-02, -8.2527e-02,  8.2405e-03, -1.3972e-02,
         -4.5330e-03,  1.2861e-01,  5.5947e-02, -1.3357e-01,  7.9001e-02,
         -9.1627e-02,  1.2748e-01, -3.3189e-02, -1.2313e-01, -8.2868e-02,
         -2.0738e-02, -7.5120e-02, -1.9838e-01, -5.1462e-02,  1.3406e-01,
          7.1782e-02,  5.9754e-02,  1.2943e-01, -1.6291e-02, -1.2361e-02,
         -9.5127e-02, -3.5291e-02, -5.4463e-02,  1.9766e-02,  7.9795e-02,
          5.1650e-02,  2.6527e-02,  3.7669e-02, -7.8447e-02, -1.2950e-01,
          3.0076e-02, -3.3822e-02, -6.5808e-02, -3.9498e-02,  8.2671e-02,
          1.5100e-01, -1.3759e-02,  1.7150e-02,  1.1856e-01,  1.7870e-01,
          1.6234e-01, -1.7568e-01, -6.4102e-02, -6.3008e-02,  2.1069e-01,
          8.6167e-02,  3.7129e-02,  2.1473e-01, -5.1070e-03,  3.0337e-02,
         -8.6460e-02, -4.8140e-02,  1.4466e-02,  1.1255e-01,  4.3306e-02,
          1.0917e-01, -1.3594e-01,  4.7389e-02, -5.2878e-02, -1.9507e-01,
         -4.5144e-02,  4.7627e-02,  9.6730e-03, -8.2566e-04, -9.2624e-02,
         -5.6419e-02, -3.9401e-02, -3.0450e-02,  1.1893e-01,  1.5174e-01,
         -1.5906e-01,  6.4472e-02,  1.2727e-01, -1.0339e-01, -7.8363e-02,
          5.9199e-02, -7.5571e-02, -5.1857e-02, -9.5273e-02,  6.6884e-02,
          6.8088e-02, -2.0958e-02,  1.6434e-01,  1.1016e-02, -6.0374e-02,
          6.2756e-02, -2.2494e-02, -4.2652e-03, -5.3606e-02, -8.5731e-02,
          1.1022e-01],
        [ 1.2647e-01,  2.1974e-02, -1.7799e-01, -4.3860e-02,  8.8778e-02,
          2.0480e-01,  1.8056e-02,  2.2607e-02, -1.0869e-01, -1.9874e-02,
          4.4657e-02, -1.5137e-02, -5.5640e-02,  8.2342e-02, -8.3340e-02,
         -7.1877e-02,  3.9177e-02,  1.7732e-02,  4.8430e-02, -8.1378e-02,
         -1.4166e-01,  1.3250e-01,  5.7068e-03,  8.0217e-02, -2.4356e-02,
          1.4663e-02,  1.0365e-01,  5.8049e-02, -4.1872e-02,  1.3483e-02,
          1.2275e-01, -6.8047e-02, -5.6021e-02, -1.4483e-01,  1.2288e-01,
         -7.6178e-02,  1.4799e-01,  1.0858e-01, -8.8437e-02, -2.0404e-01,
          8.3924e-02,  1.1665e-02, -3.8916e-02, -1.0987e-01, -1.6142e-01,
          9.2289e-02,  1.1871e-01,  1.9311e-02,  1.7466e-01, -3.3136e-02,
          1.0745e-01, -2.7250e-01, -2.9279e-02,  1.6192e-01,  5.8903e-02,
         -1.1470e-01,  5.0832e-02,  6.5421e-02,  2.5165e-01, -1.5822e-01,
         -2.7897e-01,  1.1292e-01,  9.3952e-02,  1.7640e-01, -1.3507e-01,
          6.9136e-02,  2.4462e-02,  1.3372e-02, -2.1756e-02, -2.7804e-01,
          1.0038e-01,  6.6023e-02,  1.2403e-01,  2.0432e-01, -1.9919e-02,
         -3.2780e-02, -9.2834e-02, -1.2241e-01,  4.8489e-02,  6.1388e-02,
         -8.0433e-02,  2.2131e-01, -4.0531e-02, -9.1007e-02,  1.3798e-01,
         -2.4135e-01, -6.7475e-02, -2.2700e-02, -5.3063e-02,  2.4430e-02,
          2.3689e-02,  1.5080e-01,  8.6167e-02, -2.0621e-01, -1.3779e-01,
         -5.8933e-02,  1.4094e-01, -2.4728e-02, -1.5938e-02,  1.9240e-01,
         -6.9384e-02]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(2)</code> 아래의 자료를 관찰하라.</p>
<div id="cell-14" class="cell" data-outputid="173079c1-84a7-461a-afda-5c6932ad6a98" data-execution_count="22">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> datasets.load_dataset(<span class="st">"food101"</span>, split<span class="op">=</span><span class="st">"train[:1]"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>_transforms <span class="op">=</span> torchvision.transforms.Compose([</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.Resize((<span class="dv">224</span>,<span class="dv">224</span>)),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.ToTensor(),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transforms(examples):</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    examples[<span class="st">"pixel_values"</span>] <span class="op">=</span> [_transforms(img) <span class="cf">for</span> img <span class="kw">in</span> examples[<span class="st">"image"</span>]]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> examples[<span class="st">"image"</span>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> examples</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> d.with_transform(transforms)[<span class="dv">0</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>{'label': 6,
 'pixel_values': tensor([[[0.1216, 0.1176, 0.1176,  ..., 0.0078, 0.0039, 0.0000],
          [0.1333, 0.1294, 0.1255,  ..., 0.0039, 0.0000, 0.0000],
          [0.1451, 0.1373, 0.1333,  ..., 0.0039, 0.0000, 0.0000],
          ...,
          [0.2235, 0.2157, 0.2471,  ..., 0.3569, 0.3725, 0.3529],
          [0.2627, 0.2588, 0.2314,  ..., 0.3490, 0.3608, 0.3608],
          [0.2431, 0.2627, 0.2549,  ..., 0.3373, 0.3412, 0.3373]],
 
         [[0.1373, 0.1333, 0.1333,  ..., 0.1059, 0.1020, 0.0980],
          [0.1490, 0.1451, 0.1412,  ..., 0.1020, 0.0980, 0.0941],
          [0.1608, 0.1529, 0.1490,  ..., 0.1020, 0.0941, 0.0863],
          ...,
          [0.2157, 0.2078, 0.2431,  ..., 0.3333, 0.3490, 0.3333],
          [0.2510, 0.2471, 0.2235,  ..., 0.3216, 0.3451, 0.3529],
          [0.2314, 0.2510, 0.2431,  ..., 0.3098, 0.3294, 0.3333]],
 
         [[0.1451, 0.1451, 0.1451,  ..., 0.0941, 0.0902, 0.0863],
          [0.1608, 0.1569, 0.1529,  ..., 0.0902, 0.0863, 0.0824],
          [0.1725, 0.1647, 0.1608,  ..., 0.0902, 0.0824, 0.0784],
          ...,
          [0.1412, 0.1333, 0.1647,  ..., 0.2196, 0.2353, 0.2196],
          [0.1765, 0.1725, 0.1490,  ..., 0.2078, 0.2275, 0.2314],
          [0.1569, 0.1765, 0.1686,  ..., 0.1961, 0.2118, 0.2118]]])}</code></pre>
</div>
</div>
<p><code>d</code>를 아래 <code>model</code>의 입력으로 사용하여 loss를 계산하라.</p>
<div id="cell-16" class="cell" data-outputid="7996bfcd-6b13-452b-8dbd-6257730c9662" data-execution_count="23">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    num_labels<span class="op">=</span><span class="dv">101</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-18" class="cell" data-outputid="179588b3-8682-49f6-9db2-04fb094823dc" data-execution_count="24">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model.forward(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>torch.tensor([d[<span class="st">'label'</span>]]),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    pixel_values<span class="op">=</span>torch.stack([d[<span class="st">'pixel_values'</span>]], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>ImageClassifierOutput(loss=tensor(4.5957, grad_fn=&lt;NllLossBackward0&gt;), logits=tensor([[ 0.1519,  0.0421,  0.0847, -0.0296, -0.1074,  0.0327,  0.0381,  0.1434,
          0.0762,  0.1087,  0.0567,  0.2495, -0.1418, -0.0435, -0.0919, -0.2366,
         -0.0408, -0.2031,  0.0534, -0.0367,  0.0771, -0.1781, -0.0031,  0.0235,
         -0.0508, -0.2475,  0.2553,  0.0192, -0.1095,  0.0517, -0.0726, -0.0424,
         -0.0214,  0.1052,  0.1299,  0.2157, -0.1121, -0.0293, -0.0680,  0.0239,
          0.0805,  0.2058, -0.0433,  0.0341, -0.0848, -0.0193, -0.0263,  0.0058,
         -0.0062, -0.0518, -0.0941,  0.1879, -0.0868, -0.0237, -0.0055,  0.0460,
         -0.0067,  0.1300,  0.0287, -0.0236,  0.1007,  0.2171,  0.1671, -0.0045,
          0.1083, -0.1243, -0.0193,  0.1496,  0.1563,  0.0729,  0.0076,  0.0756,
         -0.0562,  0.1650,  0.0549, -0.0824,  0.0041,  0.0151,  0.1223,  0.0802,
         -0.0875,  0.0186,  0.0311,  0.0323,  0.0155,  0.1161, -0.1092,  0.1090,
         -0.1826, -0.1482,  0.1398, -0.0812,  0.0598,  0.1545, -0.1857, -0.0157,
          0.0272,  0.0088, -0.1251, -0.0956,  0.1077]],
       grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(3)</code> 아래의 자료 <code>image1</code> <code>image2</code>를 관찰하라.</p>
<div id="cell-20" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-outputid="f3d16ff9-130f-4eba-a251-2ccadb10c867" data-execution_count="26">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Shoyu_ramen%2C_at_Kasukabe_Station_%282014.05.05%29_1.jpg/500px-Shoyu_ramen%2C_at_Kasukabe_Station_%282014.05.05%29_1.jpg"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>image1 <span class="op">=</span> Image.<span class="bu">open</span>(BytesIO(response.content))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>image1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<figure class="figure">
<p><img src="Quiz-7_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-22" class="cell" data-outputid="5efb84f1-8862-4a51-c8b2-3d222ac9e788" data-execution_count="27">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://upload.wikimedia.org/wikipedia/commons/f/f9/Bibimbap_made_by_Mrs._Jang.jpg"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>image2 <span class="op">=</span> Image.<span class="bu">open</span>(BytesIO(response.content))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>image2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<figure class="figure">
<p><img src="Quiz-7_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>image1</code>, <code>image2</code> 를 적당히 변환하여 <code>(2,3,224,224)</code> 의 tensor로 만든뒤 아래의 모형의 입력으로 사용하라.</p>
<div id="cell-24" class="cell" data-outputid="60c70bf9-72cb-4ee1-df40-b66b644173f6" data-execution_count="28">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> transformers.AutoConfig.from_pretrained(<span class="st">"google/vit-base-patch16-224-in21k"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>config.image_size <span class="op">=</span> <span class="dv">224</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>config.num_labels <span class="op">=</span> <span class="dv">101</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    config<span class="op">=</span>config,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><strong>Notes</strong></p>
<ol type="1">
<li>정규화를 생략하고 텐서 변환과 리사이즈 정도의 변환만 수행해도 정답으로 인정함.</li>
<li>라벨은 모델에 전달하지 않아도 무방함. 즉 loss는 계산하지 않아도 무방함.</li>
</ol>
<p><code>(풀이)</code></p>
<div id="cell-27" class="cell" data-outputid="87302221-39e1-46c0-abab-b683d9ac4a7a" data-execution_count="30">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> torchvision.transforms.Compose([</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.ToTensor(),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>model(pixel_values<span class="op">=</span>torch.stack([f(image1), f(image2)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.0653,  0.0641,  0.0275, -0.0767,  0.0914, -0.0843, -0.0095,  0.0794,
         -0.0525,  0.1611, -0.0290, -0.0571,  0.0638, -0.0695, -0.1568, -0.1168,
          0.1073, -0.1338,  0.0023,  0.1203, -0.0574, -0.0785, -0.0967, -0.1262,
         -0.1663,  0.0729, -0.0902, -0.2013, -0.0517,  0.0591, -0.0118, -0.0183,
          0.0222,  0.0441, -0.0946,  0.0083, -0.0043, -0.0057,  0.0671, -0.0847,
         -0.0680,  0.1215,  0.0185,  0.1103,  0.0807, -0.0700,  0.0117,  0.2419,
         -0.0970, -0.0554,  0.1159,  0.0334, -0.0426,  0.1251, -0.0690,  0.0834,
         -0.1035,  0.0099,  0.1139,  0.0088,  0.1347, -0.2821, -0.0401, -0.1899,
          0.0491,  0.2097,  0.0962, -0.1737,  0.1471, -0.0153, -0.0048, -0.0831,
         -0.0085,  0.0331,  0.0406, -0.1343, -0.0871,  0.0433, -0.1360,  0.1215,
         -0.1829,  0.0775,  0.0150, -0.0069,  0.0531,  0.0831, -0.0082, -0.0597,
         -0.1527, -0.1363,  0.0086,  0.0749, -0.0558, -0.1586, -0.0698,  0.0515,
          0.0647,  0.1985,  0.0294, -0.0328,  0.0677],
        [-0.1179, -0.1062,  0.0355,  0.0604,  0.1260,  0.1135,  0.1221, -0.0251,
          0.0042, -0.0463,  0.0140,  0.0934, -0.0124,  0.1090, -0.1515, -0.1498,
         -0.0300,  0.0317, -0.1586,  0.0770, -0.0830, -0.2840, -0.1025, -0.0301,
          0.0530, -0.1754, -0.0492, -0.1541,  0.2258, -0.0402, -0.0281,  0.0376,
          0.2181, -0.0643, -0.0585, -0.1741, -0.0757, -0.0428,  0.0436, -0.0808,
          0.0218,  0.1201,  0.0408, -0.0972,  0.0545,  0.0200,  0.0342,  0.0472,
          0.0095, -0.1572, -0.0469, -0.0249, -0.0642,  0.1126, -0.1253,  0.0170,
          0.0031, -0.1293,  0.0217, -0.0116, -0.0447, -0.0031,  0.0464, -0.0813,
          0.0625,  0.1606, -0.0825,  0.0916, -0.1614, -0.0391,  0.0022, -0.1794,
         -0.0074, -0.0214,  0.0798,  0.0706,  0.0145,  0.0276, -0.0038,  0.1055,
         -0.1081,  0.0983, -0.1621, -0.0237, -0.0073, -0.1320, -0.0418, -0.0268,
          0.1930,  0.1639,  0.0360, -0.0023,  0.1277,  0.0286,  0.0648, -0.1222,
          0.0259,  0.0614,  0.0473, -0.2201,  0.0510]],
       grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(4)</code> (3)에서의 <code>image1</code>, <code>image2</code> 를 적당히 변환하여 <code>(2,3,?,?)</code> 의 tensor로 만든뒤 아래의 모형의 입력으로 사용하라.</p>
<div id="cell-29" class="cell" data-outputid="5455f8c4-948b-45ef-8f62-2c1fdd03de0e" data-execution_count="31">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> transformers.AutoConfig.from_pretrained(<span class="st">"google/vit-base-patch16-224-in21k"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>config.image_size <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>config.num_labels <span class="op">=</span> <span class="dv">101</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForImageClassification.from_pretrained(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"google/vit-base-patch16-224-in21k"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    config <span class="op">=</span> config,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    ignore_mismatched_sizes <span class="op">=</span> <span class="va">True</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized because the shapes did not match:
- embeddings.position_embeddings: found shape torch.Size([1, 197, 768]) in the checkpoint and torch.Size([1, 17, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><strong>Notes</strong></p>
<ol type="1">
<li>정규화를 생략하고 텐서 변환과 리사이즈 정도의 변환만 수행해도 정답으로 인정함.</li>
<li>라벨은 모델에 전달하지 않아도 무방함. 즉 loss는 계산하지 않아도 무방함.</li>
</ol>
<p><code>(풀이)</code></p>
<div id="cell-32" class="cell" data-outputid="cbea39c6-30fa-4f77-e545-b0e64f8d163d" data-execution_count="32">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> torchvision.transforms.Compose([</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.ToTensor(),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    torchvision.transforms.Resize((<span class="dv">64</span>, <span class="dv">64</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>model(pixel_values<span class="op">=</span>torch.stack([f(image1), f(image2)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[ 0.0212, -0.0771, -0.0605, -0.1835, -0.1227,  0.0089, -0.0588,  0.1302,
          0.0353, -0.0484,  0.0964,  0.1646,  0.0236, -0.0040, -0.1185, -0.0121,
         -0.0385,  0.1722, -0.0205, -0.0439,  0.1443, -0.1304,  0.0570, -0.0637,
          0.1146,  0.1022, -0.0157,  0.0319,  0.0633, -0.0815,  0.0293,  0.0164,
         -0.0655,  0.0314, -0.0423,  0.1512, -0.0016, -0.1842,  0.1167,  0.0589,
         -0.0171, -0.1791, -0.0386, -0.0535,  0.0894, -0.0842,  0.0456,  0.0558,
          0.0240,  0.0595,  0.0602, -0.0988,  0.0933,  0.0183,  0.0151, -0.0570,
         -0.0357,  0.0562, -0.0198,  0.0265, -0.1284, -0.0572,  0.1064,  0.0464,
          0.0803,  0.0060,  0.0522,  0.0900, -0.0575, -0.0059, -0.0342, -0.0069,
          0.0229,  0.0527,  0.1081,  0.0243,  0.0328,  0.1047, -0.0259, -0.0383,
         -0.1083, -0.0758, -0.1305,  0.0086, -0.0492, -0.0067,  0.0770, -0.0387,
         -0.1297,  0.0194, -0.0423, -0.0907,  0.0726,  0.0027,  0.0238, -0.0398,
          0.1453, -0.1633,  0.0538, -0.1173, -0.0967],
        [ 0.1121, -0.0739, -0.0623, -0.1765,  0.1107,  0.0731, -0.2481, -0.0213,
         -0.0165, -0.1801,  0.0661,  0.1108,  0.1713, -0.0030,  0.0337, -0.0439,
         -0.0901, -0.0569, -0.1077, -0.1419,  0.0933,  0.0512,  0.0631,  0.0272,
         -0.0016, -0.0901, -0.1058, -0.1481,  0.0509, -0.0537, -0.0993,  0.0507,
         -0.1728, -0.0832,  0.1580, -0.1036,  0.1509, -0.1827, -0.1906, -0.1341,
         -0.1283,  0.0696,  0.1769, -0.0613, -0.2720, -0.0669, -0.0425, -0.1467,
         -0.0041,  0.0052,  0.0623, -0.0071,  0.0153, -0.1510, -0.0204,  0.1857,
         -0.0990, -0.0896, -0.0664,  0.0167, -0.2330, -0.0987, -0.0146, -0.1457,
          0.1045, -0.0520, -0.1489, -0.1459, -0.1953,  0.2266,  0.0794,  0.1728,
         -0.2162, -0.1092,  0.1113,  0.0851,  0.0620,  0.1316, -0.0173, -0.0890,
         -0.2102, -0.0749, -0.2449,  0.0741,  0.1630, -0.0381,  0.0046, -0.0530,
         -0.0499,  0.1425, -0.0973, -0.0361, -0.0500, -0.0883, -0.1765, -0.1511,
         -0.0355,  0.0229, -0.0891, -0.0106,  0.0021]],
       grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(5)</code> 아래의 자료를 관찰하라.</p>
<div id="cell-34" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/guebin/MP2024/refs/heads/main/posts/mbti_1.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mbti <span class="op">=</span> datasets.Dataset.from_pandas(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-outputid="2ffa029e-a78d-4fbf-a136-f5ae671fdcc0" data-execution_count="34">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform(example):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"E"</span> <span class="kw">in</span> example[<span class="st">'type'</span>]:</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        result[<span class="st">'labels'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        result[<span class="st">'labels'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> example[<span class="st">'type'</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>mbti <span class="op">=</span> mbti.<span class="bu">map</span>(transform)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"24798a726e7b432daa0d9fff1bf95b9c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="cell-36" class="cell" data-outputid="39700ffe-c65c-415d-8414-586f8d0680cf" data-execution_count="35">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> mbti.select(<span class="bu">range</span>(<span class="dv">10</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>Dataset({
    features: ['posts', 'labels'],
    num_rows: 10
})</code></pre>
</div>
</div>
<p><code>d</code>를 아래 <code>model</code>의 입력으로 사용하여 loss를 계산하라.</p>
<div id="cell-38" class="cell" data-outputid="33a98e90-d3bf-404e-e912-13276b1708fa" data-execution_count="36">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForSequenceClassification.from_pretrained(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span>, num_labels<span class="op">=</span><span class="dv">2</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"168f1fe95e694e03be22b97e550890ae","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b7270b8d75fb42e498c6c0d3fd58146a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert/distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-40" class="cell" data-outputid="c9b6da5a-b40d-492e-b03c-84b059032da6" data-execution_count="2">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> transformers.AutoTokenizer.from_pretrained(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-outputid="6b4b7eaf-b37e-4ea1-e679-9f561db7741f" data-execution_count="44">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>,truncation<span class="op">=</span><span class="va">True</span>,return_tensors<span class="op">=</span><span class="st">"pt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>{'input_ids': tensor([[  101,  1005,  8299,  ...,  2017,  2215,   102],
        [  101,  1005,  1045,  ...,  3259,  2028,   102],
        [  101,  1005,  2204,  ...,  1012,  2077,   102],
        ...,
        [  101,  1005,  1045,  ...,  2129, 15743,   102],
        [  101,  1045,  1005,  ...,  2107,  2004,   102],
        [  101,  1005, 16770,  ...,  1045,  3246,   102]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]])}</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-outputid="b3a757a6-e089-4d26-e98c-a99a42827bd4" data-execution_count="45">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model.forward(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>tokenizer(d[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>,truncation<span class="op">=</span><span class="va">True</span>,return_tensors<span class="op">=</span><span class="st">"pt"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.1040, -0.0686],
        [-0.0636, -0.0867],
        [-0.0767, -0.0764],
        [-0.0361, -0.1272],
        [-0.0618, -0.1035],
        [-0.0342, -0.1299],
        [-0.0274, -0.1071],
        [-0.0250, -0.1089],
        [-0.0660, -0.0784],
        [-0.0604, -0.1017]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(6)</code> 아래의 자료를 관찰하라.</p>
<div id="cell-44" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/guebin/MP2024/refs/heads/main/posts/mbti_1.csv"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mbti <span class="op">=</span> datasets.Dataset.from_pandas(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-outputid="145506d5-f43b-46b8-98de-1b988e2b444b" data-execution_count="5">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> transformers.AutoTokenizer.from_pretrained(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>tokenized <span class="op">=</span> tokenizer(mbti.select(<span class="bu">range</span>(<span class="dv">2</span>))[<span class="st">'posts'</span>],padding<span class="op">=</span><span class="va">True</span>,return_tensors<span class="op">=</span><span class="st">"pt"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>tokenized</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Token indices sequence length is longer than the specified maximum sequence length for this model (2102 &gt; 512). Running this sequence through the model will result in indexing errors</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>{'input_ids': tensor([[ 101, 1005, 8299,  ...,    0,    0,    0],
        [ 101, 1005, 1045,  ..., 1012, 1005,  102]]), 'attention_mask': tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 1, 1, 1]])}</code></pre>
</div>
</div>
<p><code>tokenized</code>를 입력으로 받을수 있는 모형을 설계하고 아래를 실행하라. (loss는 계산하지 않아도 무방함)</p>
<div id="cell-47" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model(**tokenized)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-49" class="cell" data-outputid="ac61defb-d5cb-4685-9951-315c3c4eb46a" data-execution_count="6">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tokenized[<span class="st">'input_ids'</span>].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>torch.Size([2, 2102])</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> transformers.AutoConfig.from_pretrained(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"distilbert/distilbert-base-uncased"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>config.max_position_embeddings <span class="op">=</span> <span class="dv">2273</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.AutoModelForSequenceClassification.from_config(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    config<span class="op">=</span>config</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell" data-outputid="b0aeb63e-d13e-4de9-9b76-eca897d1e817" data-execution_count="8">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>model(<span class="op">**</span>tokenized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0858,  0.8048],
        [-0.0705,  0.4062]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(7)</code> 아래는 음성인식을 위한 모델이다.</p>
<div id="cell-53" class="cell" data-outputid="9cd556bf-60b4-462e-d605-03cd74f7d6b5" data-execution_count="10">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span>transformers.AutoModelForAudioClassification.from_pretrained(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"facebook/wav2vec2-base"</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9fc608c582284f7eb864fdd5f4cdac34","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/transformers/configuration_utils.py:306: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
Some weights of Wav2Vec2ForSequenceClassification were not initialized from the model checkpoint at facebook/wav2vec2-base and are newly initialized: ['classifier.bias', 'classifier.weight', 'projector.bias', 'projector.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b6beb3e2a7e14a1c9da8862bf622e8de","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>이 모델의 입력을 아래와 같이 설정하였으나 에러가 발생했다.</p>
<div id="cell-55" class="cell" data-outputid="c9e1d4e4-ae89-4971-bb6e-9cbd0ac2ec8e" data-execution_count="11">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>model(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    input_values <span class="op">=</span> torch.tensor([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1000</span>).reshape(<span class="dv">1</span>,<span class="dv">1000</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    attention_mask <span class="op">=</span> torch.tensor([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1000</span>).reshape(<span class="dv">1</span>,<span class="dv">1000</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>RuntimeError: expected scalar type Long but found Float</code></pre>
</div>
</div>
<p>코드를 수정하여 올바른 입력데이터를 넣어라.</p>
<p><code>(풀이)</code></p>
<div id="cell-58" class="cell" data-outputid="d57bcf1c-6213-403d-e2a3-eb696e799429" data-execution_count="13">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>model(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    input_values <span class="op">=</span> torch.tensor([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1000</span>).reshape(<span class="dv">1</span>,<span class="dv">1000</span>).<span class="bu">float</span>(),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    attention_mask <span class="op">=</span> torch.tensor([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1000</span>).reshape(<span class="dv">1</span>,<span class="dv">1000</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>SequenceClassifierOutput(loss=None, logits=tensor([[-0.0334,  0.1047]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
</section>
<section id="with" class="level1">
<h1>2. <code>with</code></h1>
<p><code>(1)</code> 아래의 코드를 관찰하라.</p>
<div id="cell-61" class="cell" data-outputid="c2c368cb-2495-4725-87df-02dab838af1b" data-execution_count="2">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tsr <span class="op">=</span> torch.randn(<span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.VideoMAEForVideoClassification.from_pretrained(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MCG-NJU/videomae-base"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>model(tsr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
Some weights of VideoMAEForVideoClassification were not initialized from the model checkpoint at MCG-NJU/videomae-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[ 0.4060,  0.1346],
        [ 0.1393,  0.0789],
        [ 0.1066,  0.0795],
        [ 0.1970, -0.0070],
        [ 0.1905,  0.1503],
        [ 0.2089,  0.1376],
        [ 0.0104, -0.0011],
        [ 0.2811,  0.1901],
        [ 0.2035,  0.1625],
        [ 0.2755, -0.0095]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>with torch.no_grad()</code> 를 사용하여 <code>logits</code>에 <code>grad_fn=&lt;AddmmBackward0&gt;</code> 이 포함되지 않도록 위 코드를 수정하라.</p>
<p><code>(풀이)</code></p>
<div id="cell-64" class="cell" data-outputid="f0b929d0-a604-4545-c66e-0689c5e89131" data-execution_count="4">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(model(tsr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[ 0.4060,  0.1346],
        [ 0.1393,  0.0789],
        [ 0.1066,  0.0795],
        [ 0.1970, -0.0070],
        [ 0.1905,  0.1503],
        [ 0.2089,  0.1376],
        [ 0.0104, -0.0011],
        [ 0.2811,  0.1901],
        [ 0.2035,  0.1625],
        [ 0.2755, -0.0095]]), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(2)</code> 아래의 코드를 관찰하라.</p>
<div id="cell-66" class="cell" data-outputid="16cb92ed-e181-40c3-aaa7-5353efbfbcd0" data-execution_count="3">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>tsr <span class="op">=</span> torch.randn(<span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> transformers.VideoMAEForVideoClassification.from_pretrained(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MCG-NJU/videomae-base"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>model(tsr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
Some weights of VideoMAEForVideoClassification were not initialized from the model checkpoint at MCG-NJU/videomae-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.1040, -0.0061],
        [-0.0597,  0.2367],
        [-0.2060,  0.2247],
        [-0.2293,  0.1689],
        [-0.2859,  0.1811],
        [-0.2340,  0.1257],
        [-0.0881,  0.1403],
        [-0.2519,  0.1412],
        [-0.1075,  0.0054],
        [-0.2806,  0.1081]], grad_fn=&lt;AddmmBackward0&gt;), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p>아래와 같이 동작하는 적절한 클래스 <code>NoGradContext</code> 를 설계하라.</p>
<div id="cell-68" class="cell" data-outputid="634d16b6-41a8-4d66-c55e-9686cbe5078a" data-execution_count="6">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> NoGradContext():</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    tsr <span class="op">=</span> torch.randn(<span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> transformers.VideoMAEForVideoClassification.from_pretrained(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MCG-NJU/videomae-base"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(model(tsr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some weights of VideoMAEForVideoClassification were not initialized from the model checkpoint at MCG-NJU/videomae-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ImageClassifierOutput(loss=None, logits=tensor([[-0.2523, -0.5055],
        [-0.1680, -0.5540],
        [-0.3205, -0.4462],
        [-0.1461, -0.6196],
        [-0.1723, -0.6704],
        [-0.1323, -0.5601],
        [-0.2817, -0.4697],
        [-0.1575, -0.4805],
        [-0.2094, -0.4485],
        [-0.2593, -0.5014]]), hidden_states=None, attentions=None)</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-70" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NoGradContext:</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    torch.set_grad_enabled(<span class="va">False</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>,<span class="op">*</span>args):</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    torch.set_grad_enabled(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>(3)</code> 아래와 같은 <code>dataframe</code>을 살펴보자.</p>
<div id="cell-72" class="cell" data-outputid="7d4dd4e6-2251-4a08-fd12-38b83153e004" data-execution_count="7">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.randn(<span class="dv">61</span>,<span class="dv">2</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>display(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

  <div id="df-97a88934-b5b8-4310-bdda-8302d99fe9db" class="colab-df-container">
    <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.797597</td>
<td>-0.509486</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.026591</td>
<td>-1.130091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.774137</td>
<td>-0.393504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.859450</td>
<td>-0.689825</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.930429</td>
<td>-0.715551</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>-0.720481</td>
<td>-0.116972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>-1.127292</td>
<td>2.401930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>1.819896</td>
<td>2.160495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>-0.034305</td>
<td>0.247947</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>-0.354988</td>
<td>0.184486</td>
</tr>
</tbody>
</table>

<p>61 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-97a88934-b5b8-4310-bdda-8302d99fe9db')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-97a88934-b5b8-4310-bdda-8302d99fe9db button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-97a88934-b5b8-4310-bdda-8302d99fe9db');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9c722eec-5fa8-4da3-9aba-b2701701c7d3">
  <button class="colab-df-quickchart" onclick="quickchart('df-9c722eec-5fa8-4da3-9aba-b2701701c7d3')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9c722eec-5fa8-4da3-9aba-b2701701c7d3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_258f93db-fd93-4b29-927d-a519584bf1cd">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_258f93db-fd93-4b29-927d-a519584bf1cd button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
<p>이 <code>df</code>에는 일부 rows가 생략되어 출력되는데, 이는 때때로 불편하다. 생략되지 않은 출력을 잠시 보기 위하여 아래와 같은 코드를 사용할 수 있다.</p>
<div id="cell-74" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.set_option('display.max_rows', None)  # 모든 행 출력</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># display(df) # 모든행이 출력됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-75" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.reset_option('display.max_rows') # 원래상태로 복원</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># display(df) # 다시 일부행만 출력됨</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>때떄로 모든 행을 출력하고 싶을때를 대비하여 아래와 같은 동작이 가능한 적당한 클래스 <code>DisplayAllRows</code>을 설계하라.</p>
<div id="cell-77" class="cell" data-outputid="dc9d11c8-b8cf-42aa-e209-bdc181bfb2a4" data-execution_count="8">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # 평소에는 생략된출력</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># display(df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-78" class="cell" data-outputid="df42c3f8-7143-447f-8b1d-d865740914f7" data-execution_count="9">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # 원할때는 모든 rows를 출력</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with DisplayAllRows():</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     display(df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>(풀이)</code></p>
<div id="cell-80" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DisplayAllRows:</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>,<span class="op">*</span>args):</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    pd.reset_option(<span class="st">'display.max_rows'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"04561d26347043d390b4300b55f77d03":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0d1587e426d240abb5de16c1b987ca00":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3551eb87ae604664b204f36f980f82f9","IPY_MODEL_95a3199f54f94f0aa8587ab5d0df7c90","IPY_MODEL_6cffdfde00c245ea818e2b8d975bc1c6"],"layout":"IPY_MODEL_4c9afc0e0b4242febfec1a3c60a2f540"}},"0d67da8da7bc4b6981904680cf7c8987":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b6bc7eaed9da4528ba566894252a2bcf","placeholder":"​","style":"IPY_MODEL_806c86d1078148ad9f1752eca6490f9f","value":" 8675/8675 [00:01&lt;00:00, 6945.37 examples/s]"}},"0e5640666d984974b1e2ba12318a9378":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0f185460c1c34c6288bb0813a11af58d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d9deb12947b64a47a0cdc864d0630c75","placeholder":"​","style":"IPY_MODEL_73b9bc41d19a4b2685c860f9603eba3b","value":" 346M/346M [00:02&lt;00:00, 168MB/s]"}},"12e2400fb2794b1b8226005ead7ecd5d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"168f1fe95e694e03be22b97e550890ae":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e1637de1422d4ddfbf25443aa5cb0146","IPY_MODEL_169ad63f66dc43c6b3ab7eea71819d43","IPY_MODEL_a8e76ebbfe254bf7b10cf403004fb4db"],"layout":"IPY_MODEL_c67c12dbe76e44c280d6d1445ec8b4b2"}},"169ad63f66dc43c6b3ab7eea71819d43":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_88a7173b207e4097844e701c166bee19","max":483,"min":0,"orientation":"horizontal","style":"IPY_MODEL_73a1964db207405084f4e4e5101ebad1","value":483}},"16cf41a1700744ceb152f488a2db5038":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1ae0efe6f76443b0928e9d222a1031c0":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f4432db89cf34b3cabd0677f931c3fcd","max":1842,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9426e4084fd141a2803914da6be9eb96","value":1842}},"24798a726e7b432daa0d9fff1bf95b9c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d1953d0acc2d4370b4009797d882bd84","IPY_MODEL_58d991c38b8d49459635a3d497dbb07a","IPY_MODEL_0d67da8da7bc4b6981904680cf7c8987"],"layout":"IPY_MODEL_8269c59b894f40d59e3224597ea9a788"}},"2677ce3b5eca4a05b3824fddadd154f2":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2f66bee988b84dd98202a0df4bc3862f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_be0acc1e6dec46af824447f291c5ca83","placeholder":"​","style":"IPY_MODEL_3bad13bf3c18434aa7cf4b1aef8e9627","value":" 380M/380M [00:06&lt;00:00, 25.2MB/s]"}},"3358307ec92147deac644ec2d88c490a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3551eb87ae604664b204f36f980f82f9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37854360606c401980b0da0133a11c7a","placeholder":"​","style":"IPY_MODEL_0e5640666d984974b1e2ba12318a9378","value":"config.json: 100%"}},"36e2ec005330425f9d7519bd8119f434":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e2d725d4f67a4a4b9790148b0adc515c","placeholder":"​","style":"IPY_MODEL_cb0bdc9087394480a6337983ed0e995f","value":"model.safetensors: 100%"}},"37854360606c401980b0da0133a11c7a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3bad13bf3c18434aa7cf4b1aef8e9627":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4c9afc0e0b4242febfec1a3c60a2f540":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"58d991c38b8d49459635a3d497dbb07a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8870b04199584d90831aa133aab1c40e","max":8675,"min":0,"orientation":"horizontal","style":"IPY_MODEL_daed9892014d4190af7e3638cfde9001","value":8675}},"698944368e3d4fddb5082059c61a3843":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6a30c509c81749b3aadb1acd7e237496":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6cffdfde00c245ea818e2b8d975bc1c6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a30c509c81749b3aadb1acd7e237496","placeholder":"​","style":"IPY_MODEL_12e2400fb2794b1b8226005ead7ecd5d","value":" 502/502 [00:00&lt;00:00, 9.18kB/s]"}},"6e7c436a1d11487e82afa8d43b9585d0":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"73a1964db207405084f4e4e5101ebad1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"73b9bc41d19a4b2685c860f9603eba3b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7a76dca689ef4e5380c52011a372d0f3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7d2a0215469a42349a869c8a3df92342":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6e7c436a1d11487e82afa8d43b9585d0","max":267954768,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fdfc421484d0437d987f3f57955c2cf8","value":267954768}},"806c86d1078148ad9f1752eca6490f9f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8269c59b894f40d59e3224597ea9a788":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8311f06116624be68fa21604ddef71c6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"84db5241e5814ecf99aaec32a9d56ff7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8a24cdc150d4442f84007e7dba3c7743","placeholder":"​","style":"IPY_MODEL_c303c24442ee46c6910739f58ba4f969","value":" 268M/268M [00:01&lt;00:00, 155MB/s]"}},"8870b04199584d90831aa133aab1c40e":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"88a7173b207e4097844e701c166bee19":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89f3c319b7af45af84b3865e036f205d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3358307ec92147deac644ec2d88c490a","placeholder":"​","style":"IPY_MODEL_f858cda356c447589e2053aaf7c6a364","value":"model.safetensors: 100%"}},"8a24cdc150d4442f84007e7dba3c7743":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8acfda61bf6a4695977948db1c0754a5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"93cfad354e6e4012bae54eb99970754a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9426e4084fd141a2803914da6be9eb96":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9541ebfa71564e4f818c08e4a5a56490":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"95a3199f54f94f0aa8587ab5d0df7c90":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bccf026afe9d4209ad88ece30a208228","max":502,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a579a52bb02c4c0ea698c3aaed7dbd0d","value":502}},"9fc608c582284f7eb864fdd5f4cdac34":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d4a06bcb6f8f4227a753018de051e49b","IPY_MODEL_1ae0efe6f76443b0928e9d222a1031c0","IPY_MODEL_c6453841c07e486c95e4affbe0f95fa1"],"layout":"IPY_MODEL_cc4783b5031548a0b6eaa23988c6ecde"}},"a30806c13c434fbfbe21e34405244d16":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a579a52bb02c4c0ea698c3aaed7dbd0d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a8e76ebbfe254bf7b10cf403004fb4db":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_698944368e3d4fddb5082059c61a3843","placeholder":"​","style":"IPY_MODEL_8acfda61bf6a4695977948db1c0754a5","value":" 483/483 [00:00&lt;00:00, 35.5kB/s]"}},"b105ee0d7ea84bb483ba7c61205001cf":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b54f9e724ca44b4e9ed6bef1b0c40785":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6bc7eaed9da4528ba566894252a2bcf":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6beb3e2a7e14a1c9da8862bf622e8de":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bae9885e4f014dda8c6ebb002c40735a","IPY_MODEL_dcc93821337a49daa4334000173db9e2","IPY_MODEL_2f66bee988b84dd98202a0df4bc3862f"],"layout":"IPY_MODEL_fc81cba1ea56430caed66a3a3a2b5dff"}},"b6c394f8669b4ce4b659852e6204685b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b7270b8d75fb42e498c6c0d3fd58146a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_89f3c319b7af45af84b3865e036f205d","IPY_MODEL_7d2a0215469a42349a869c8a3df92342","IPY_MODEL_84db5241e5814ecf99aaec32a9d56ff7"],"layout":"IPY_MODEL_16cf41a1700744ceb152f488a2db5038"}},"b92e5628569d44ffb6e1b6a193269771":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bae9885e4f014dda8c6ebb002c40735a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b105ee0d7ea84bb483ba7c61205001cf","placeholder":"​","style":"IPY_MODEL_7a76dca689ef4e5380c52011a372d0f3","value":"pytorch_model.bin: 100%"}},"bccf026afe9d4209ad88ece30a208228":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be0acc1e6dec46af824447f291c5ca83":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c303c24442ee46c6910739f58ba4f969":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c3bd569075464514b9afda6c74d5adfc":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9541ebfa71564e4f818c08e4a5a56490","max":345579424,"min":0,"orientation":"horizontal","style":"IPY_MODEL_04561d26347043d390b4300b55f77d03","value":345579424}},"c6453841c07e486c95e4affbe0f95fa1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d74d1a365e4043d382ca4e8152ab8878","placeholder":"​","style":"IPY_MODEL_8311f06116624be68fa21604ddef71c6","value":" 1.84k/1.84k [00:00&lt;00:00, 135kB/s]"}},"c67c12dbe76e44c280d6d1445ec8b4b2":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb0bdc9087394480a6337983ed0e995f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cba2cebb4f964497bbcab38d0d40a48c":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc4783b5031548a0b6eaa23988c6ecde":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d0b0cc972e75431eaa9bcb971eb15f55":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d1953d0acc2d4370b4009797d882bd84":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b92e5628569d44ffb6e1b6a193269771","placeholder":"​","style":"IPY_MODEL_93cfad354e6e4012bae54eb99970754a","value":"Map: 100%"}},"d4a06bcb6f8f4227a753018de051e49b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b54f9e724ca44b4e9ed6bef1b0c40785","placeholder":"​","style":"IPY_MODEL_2677ce3b5eca4a05b3824fddadd154f2","value":"config.json: 100%"}},"d74d1a365e4043d382ca4e8152ab8878":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d836f9819ac84a7f81fe406536a92bbb":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_36e2ec005330425f9d7519bd8119f434","IPY_MODEL_c3bd569075464514b9afda6c74d5adfc","IPY_MODEL_0f185460c1c34c6288bb0813a11af58d"],"layout":"IPY_MODEL_cba2cebb4f964497bbcab38d0d40a48c"}},"d9deb12947b64a47a0cdc864d0630c75":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"daed9892014d4190af7e3638cfde9001":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"dcc93821337a49daa4334000173db9e2":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f6c84bf168154350bc72e0251f3ed70e","max":380267417,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a30806c13c434fbfbe21e34405244d16","value":380267417}},"e1637de1422d4ddfbf25443aa5cb0146":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d0b0cc972e75431eaa9bcb971eb15f55","placeholder":"​","style":"IPY_MODEL_b6c394f8669b4ce4b659852e6204685b","value":"config.json: 100%"}},"e2d725d4f67a4a4b9790148b0adc515c":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f4432db89cf34b3cabd0677f931c3fcd":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f6c84bf168154350bc72e0251f3ed70e":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f858cda356c447589e2053aaf7c6a364":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fc81cba1ea56430caed66a3a3a2b5dff":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fdfc421484d0437d987f3f57955c2cf8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>